

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>正则表达式 &mdash; zzq&#39;s blog</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/my_theme.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="../genindex.html"/>
        <link rel="search" title="搜索" href="../search.html"/>
    <link rel="top" title="zzq&#39;s blog" href="../index.html"/>
        <link rel="up" title="算法与问题" href="index.html"/>
        <link rel="next" title="hyperscan介绍" href="hs_intro.html"/>
        <link rel="prev" title="AC算法" href="ac.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> 赵子清技术文章
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../dpdk/index.html">DPDK</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/eal.html">1. EAL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#linuxeal">1.1. Linux环境的EAL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#id1">1.2. 内存机制与初始化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#cpu">1.3. CPU信息取得与核绑定</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#lcore">1.4. 线程/lcore的初始化与启动</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#id2">1.5. 多进程应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#id3">1.6. 其他注意事项</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/eal.html#id4">1.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/ring.html">2. Ring</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id1">2.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id4">2.2. 应用场景</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id5">2.3. 无锁队列操作图解</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/ring.html#step1">2.3.1. Step1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/ring.html#step2">2.3.2. Step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/ring.html#step3">2.3.3. Step3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/ring.html#step4">2.3.4. Step4</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/ring.html#step5">2.3.5. Step5</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id6">2.4. 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id7">2.5. 多生产者入队</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id8">2.6. 多消费者出队</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id9">2.7. 索引计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/ring.html#id10">2.8. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/mem.html">3. Memory</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mem.html#id1">3.1. 内存的初始化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mem.html#id2">3.1.1. 大页信息初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mem.html#id3">3.1.2. 大页内存初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mem.html#memzone">3.1.3. memzone初始化</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mem.html#id6">3.2. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/memseg.html">4. Memseg</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memseg.html#id1">4.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memseg.html#id2">4.2. 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memseg.html#id3">4.3. 初始化</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/memzone.html">5. Memzone</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memzone.html#id1">5.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memzone.html#memzone-init">5.2. 初始化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memzone.html#id3">5.3. 内存分配</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memzone.html#id4">5.4. 内存释放</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/memzone.html#id5">5.5. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/malloc.html">6. Malloc</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#id1">6.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#id2">6.2. 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#malloc-heap">6.3. malloc heap初始化</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#malloc-heap-alloc">6.4. 内存分配</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#id4">6.5. 内存释放</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/malloc.html#id5">6.6. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/mempool.html">7. Mempool</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id1">7.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id2">7.2. 特性</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mempool.html#id3">7.2.1. 内存对齐</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mempool.html#cache">7.2.2. Cache机制</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id4">7.3. 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id5">7.4. 创建</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id6">7.5. 取出对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id7">7.6. 还回对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mempool.html#id8">7.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/mbuf.html">8. Mbuf</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id1">8.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id2">8.2. 原理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id3">8.3. 数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id4">8.4. 分配与回收</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mbuf.html#id5">8.4.1. 初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mbuf.html#id6">8.4.2. 分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/mbuf.html#id7">8.4.3. 回收</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id8">8.5. 元信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#directindirect-mbuf">8.6. Direct和Indirect mbuf</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/mbuf.html#id9">8.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/build_sys.html">9. 编译系统</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#id2">9.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#id3">9.2. 源码组织</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#config">9.2.1. config</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#mk">9.2.2. mk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#drivers">9.2.3. drivers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#lib">9.2.4. lib</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#tools">9.2.5. tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#app">9.2.6. app</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#examples">9.2.7. examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#id5">9.3. 编译系统</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#dpdk">9.3.1. 编译dpdk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id6">9.3.2. 编译外部程序</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#dpdk-makefile">9.4. dpdk Makefile介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id7">9.4.1. 一般规则</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id8">9.4.2. 类型</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id13">9.4.3. 常用变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#makefile">9.4.4. 仅可以在Makefile中设置的变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id14">9.4.5. 仅可以在命令行中设置的变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id15">9.4.6. 可以在Makefile或命令行中设置的变量</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#root-makefile-help">9.5. 根Makefile介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#config-target">9.5.1. config target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#build-target">9.5.2. build target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#install-target">9.5.3. install target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#test-target">9.5.4. test target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#target">9.5.5. 文档target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#deps-target">9.5.6. deps target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id17">9.5.7. 杂项target</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id18">9.5.8. 其他命令行变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#debug">9.5.9. 编译Debug版本</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#abi">9.6. ABI管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id19">9.6.1. 什么是ABI</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#dpdk-abi">9.6.2. DPDK ABI策略</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id20">9.6.3. ABI宏及示例</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#id21">9.6.4. 验证ABI</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#v16-07-2">9.7. 实例：将v16.07.2编译为单个动态库</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#config-common-base">9.7.1. config/common_base</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#mk-rte-lib-mk">9.7.2. mk/rte.lib.mk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#mk-rte-combinedlib-mk">9.7.3. mk/rte.combinedlib.mk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#mk-rte-app-mk">9.7.4. mk/rte.app.mk</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/build_sys.html#libdpdk-map">9.7.5. libdpdk.map</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/build_sys.html#id22">9.8. 参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dpdk/optimization.html">10. dpdk软件性能优化技术</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/optimization.html#id1">10.1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dpdk/optimization.html#cache">10.2. Cache和内存</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../dpdk/optimization.html#id2">10.2.1. 内存Cache简介</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tcpip/index.html">TCP/IP详解</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">算法与问题</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="ac.html">AC算法</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">正则表达式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">1. 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parse">2. 解析(parse)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id3">2.1 词法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">2.2 语法</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">2.3 抽象语法树</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#compile">3. 编译(compile)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#nfa">3.1 构造NFA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#nfadfa">3.2 NFA转DFA</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">3.4 消除死状态</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dfa">3.5 DFA最小化</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">3.6 DFA序列化</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#match">4. 匹配(match)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">5. 优化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">5.1 内存</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">5.2 性能</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hs_intro.html">hyperscan介绍</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#how-we-match-regular-expressions">首席工程师: How we match regular expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#id1">源码结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#gdb-compile">gdb分析: compile</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hs_intro.html#rose-add">rose-&gt;add()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#gdb-match">gdb分析: match</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#id2">gdb分析: 带^锚点的compile</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#id3">gdb分析: 带^锚点的match</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_intro.html#id4">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hs_pre.html">hyperscan预备知识</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hs_pre.html#c-11">C++ 11</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_pre.html#boost-graph-library">Boost Graph Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="hs_pre.html#ragel">Ragel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hs_debug.html">hyperscan调试环境与技巧</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hs_debug.html#id1">编译</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hs_debug.html#id2">第3方依赖库</a></li>
<li class="toctree-l4"><a class="reference internal" href="hs_debug.html#cmake">CMake配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="hs_debug.html#id3">编译过程</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hs_debug.html#id4">生成源码文档</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hs_parse.html">hyperscan表达式解析</a></li>
<li class="toctree-l2"><a class="reference internal" href="hs_compile.html">hyperscan编译期</a></li>
<li class="toctree-l2"><a class="reference internal" href="hs_scan.html">hyperscan运行时匹配</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../netalgo/index.html">网络算法学</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../netalgo/proto_process.html">9 Protocol Processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/proto_process.html#id1">9.1 缓存管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/proto_process.html#id2">9.1.1 缓存分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/proto_process.html#id3">9.1.2 缓存的共享</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/proto_process.html#dpdk">9.1.3 dpdk内存实现</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/proto_process.html#crcchecksum">9.2 CRC和Checksum</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/proto_process.html#id4">9.3 通用协议处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/proto_process.html#id5">9.4 重组</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/proto_process.html#id6">9.4.1 高效重组</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/proto_process.html#id7">9.5 结论</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../netalgo/sched_packet.html">14 Scheduling Packets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id1">14.1 概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id2">14.2 拥塞控制</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id4">14.2.1 设计目标</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id5">14.2.2 算法</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#wred">14.2.3 WRED</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#dpdk-red">14.2.4 dpdk red的相关实现</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id13">14.3 带宽与突发限制</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id16">14.3.1 基本原理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#srtcm">14.3.2 srTCM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#trtcm">14.3.3 trTCM</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#dpdk-meter">14.3.4 dpdk_meter的相关实现</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id24">14.4 多队列与优先级</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id25">14.5 资源预留协议</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id26">14.6 带宽保证</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id27">14.6.1 问题引入</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#deficit-round-robin">14.6.1 Deficit Round-Robin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#drr">14.6.2 DRR的实现与扩展</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id30">14.7 时延保证</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#scalable-fair-queuing">14.8 Scalable Fair Queuing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#dpdk">14.9 dpdk分层调度</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id31">14.9.1 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id32">14.9.2 调度分层</a></li>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#id33">14.9.3 实现</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#diffserv">14.10 DiffServ架构介绍</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#dpdk-qos">14.11 dpdk QoS框架</a></li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id37">附录</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../netalgo/sched_packet.html#ewma">EWMA</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../netalgo/sched_packet.html#id38">参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../wireshark/index.html">wireshark</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../lang/index.html">程序设计语言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../lang/cpp11.html">C++ 11</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lang/lua_basic.html">lua基础</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../lang/lua_basic.html#id1">预备知识</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id2">获得lua</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id3">lua命令行</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id4">保留关键字</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id5">注释</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#chunk">Chunk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lang/lua_basic.html#id6">数据类型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#string">string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#userdata">userdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#thread">thread</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lang/lua_basic.html#id7">表达式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id8">算术运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id9">关系运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id10">逻辑运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id11">连接运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id12">运算符优先级</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lang/lua_basic.html#id13">语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id14">赋值</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id15">局部变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id16">条件语句</a></li>
<li class="toctree-l4"><a class="reference internal" href="../lang/lua_basic.html#id17">循环语句</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../lang/lua_basic.html#id18">函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../lang/pcasm.html">PC Assembly Language读书笔记</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../shell/index.html">Linux shell编程</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../perf/index.html">性能优化</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../perf/vtune.html">Intel VTune Amplifier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../perf/vtune.html#id1">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf/vtune.html#id2">一般应用: 图形界面</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf/vtune.html#id3">一般应用: 命令行</a></li>
<li class="toctree-l3"><a class="reference internal" href="../perf/vtune.html#vtune">附录: VTune中文在线课程</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">工具与杂项</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tools/vim/index.html">Vim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/vim/intro.html">简介与基本配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/vim/intro.html#vim">为什么要使用vim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/vim/intro.html#id2">本系列文章的指导思想和一些约定</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/vim/intro.html#id3">学习之前的基本配置和几个需要了解的基本操作</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/git/index.html">Git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/git/basic_command.html">Git常用命令</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id2">一、新建代码库</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id3">二、配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id4">三、增加/删除文件</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id5">四、代码提交</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id6">五、分支</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id7">六、标签</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id8">七、查看信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id9">八、远程同步</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id10">九、撤销</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/basic_command.html#id11">十、其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/git/tricks.html">小技巧</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/tricks.html#shellsshgithub">shell通过SSH连接github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/git/tricks.html#id2">在命令提示符中显示当前分支</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/rest/index.html">用reST编写文档</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/intro.html">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/setup.html">安装与基本使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/setup.html#id2">安装软件包</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/setup.html#id3">项目建立</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/setup.html#conf-py">conf.py配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/setup.html#index">index页配置</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/grammar.html">reST语法介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id1">章节标题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id2">段落</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id3">行内标记</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id4">列表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id5">代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id6">超链接</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id7">图片</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id8">表格</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id9">引用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id10">脚注</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id11">提醒</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id12">替换</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/grammar.html#id13">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/style.html">修改样式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/style.html#step1">Step1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/style.html#step2">Step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/style.html#step3">Step3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/topdf.html">生成PDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/topdf.html#xetex">方法一：使用xeTex(推荐)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/topdf.html#cjkutf8">方法二: 使用CJKutf8包 (默认)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/topdf.html#id1">终极解决办法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/doxygen.html">生成API文档</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/doxygen.html#step1">Step1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/doxygen.html#step2">Step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/doxygen.html#step3">Step3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/doxygen.html#step4">Step4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/with_vscode.html">在Visual Studio Code中使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/with_vscode.html#id1">安装步骤</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/with_vscode.html#id2">配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/with_vscode.html#id3">使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/with_vscode.html#id4">问题记录</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/rest/add_comment.html">给github博客添加评论功能</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/add_comment.html#oauth-application">1. 注册OAuth Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/add_comment.html#id1">2. 编辑博客页面, 引入gitment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/add_comment.html#id2">3. 初始化评论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/rest/add_comment.html#id3">参考链接</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/latex/index.html">LaTeX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/setup.html">安装与配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/latex/setup.html#id2">1. 安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/latex/setup.html#id3">2. 卸载</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/quick_start.html">快速入门示例</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/text.html">文本与段落</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/code.html">程序代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/figure_table.html">图像与表格</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/latex/debug.html">错误调试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/patch.html">补丁工具patch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/patch.html#id1">1 为单个文件生成补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/patch.html#id2">2 为多个文件生成补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/patch.html#id3">3 打补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/patch.html#id4">4 示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/libpcap.html">libpcap使用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#id1">创建句柄</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-open-offline">pcap_open_offline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-dump-open">pcap_dump_open</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#id2">关闭句柄</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-close">pcap_close</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-dump-close">pcap_dump_close</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#packet">读取packet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-open-pcap-dispatch">pcap_open/pcap_dispatch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#id3">设置选项</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-set-promisc">pcap_set_promisc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#id4">其他</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-breakloop">pcap_breakloop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-file">pcap_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/libpcap.html#pcap-dump-file">pcap_dump_file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/libpcap.html#id5">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/cunit.html">CUnit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/cunit.html#cunit-2-1-3">编译安装CUnit-2.1-3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/centos.html">CentOS应用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/centos.html#centos7-3minimalc-c">CentOS7.3Minimal从零配置C/C++开发环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/centos.html#failed-to-start-lsb-bring-up-down-networking">网络配置失败,显示Failed to start LSB: Bring up/down networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/centos.html#centoswindows">共享CentOS虚拟机上的文件给Windows本机访问</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tools/xiaomi_router.html">小米路由器开发</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tools/xiaomi_router.html#rom">用ROM刷机</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/xiaomi_router.html#ssh">开启SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/xiaomi_router.html#id2">交叉编译环境搭建</a></li>
<li class="toctree-l3"><a class="reference internal" href="../tools/xiaomi_router.html#id3">交叉编译库或工具</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/xiaomi_router.html#libpcap">编译libpcap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/xiaomi_router.html#helloworld">编译helloworld</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tools/xiaomi_router.html#gdb">编译gdb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tools/xiaomi_router.html#id4">其他</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tools/xiaomi_router.html#id5">在小米路由器上部署静态网页</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../hobby/index.html">兴趣爱好</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../hobby/prepare.html">准备工作</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../hobby/prepare.html#b">如何下载B站视频，或者小偶像用微博发的视频？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hobby/prepare.html#mac">Mac系统下应该用什么软件做视频编辑？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hobby/prepare.html#q-mac-gif">Q: Mac系统如何做动图（gif）？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hobby/prepare.html#gif-fcpx">我有一些动图（gif），怎么将它们导入到fcpx？直接导入发现它们不动了啊！</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hobby/prepare.html#id2">Mac系统如何录制系统自己发出的声音，比如我正在听一首很好听的歌但是不方便下载它？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hobby/fcpx_basic.html">FCPX: XXX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../hobby/fcpx_basic.html#library">资源库（Library）</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hobby/fcpx_basic.html#id1">疑难点</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">赵子清技术文章</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">算法与问题</a> &raquo;</li>
        
      <li>正则表达式</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>正则表达式<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<div class="section" id="id2">
<h2>1. 概述<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>正则表达式在现实中有着极为重要的作用, 很多软件使用了正则表达式, 很多语言也提供了正则表达式支持, 虽然其内部实现方式各有不同.</p>
<p>本文不打算讨论PCRE和re等通用正则引擎, 而是尝试从原理到实现来讨论一种和
<a class="reference external" href="https://github.com/intel/hyperscan">hyperscan</a>
功能相似的多模正则引擎zre.</p>
<p>本文内容涉及到了词法和语法分析, 有限状态机等知识, 可以参考《编译原理》.</p>
<p>正则引擎的工作流程主要分为:</p>
<ol class="arabic simple">
<li>解析. 将正则表达式转换为抽象语法树(AST)</li>
<li>编译. 将AST编译为非确定性有限自动机(NFA)</li>
<li>转换. 将NFA转换为确定性有限自动机(DFA)</li>
<li>匹配. 将数据依次送入NFA/DFA, 给出匹配结果</li>
</ol>
<p>其中前3步如下图所示:</p>
<img alt="../_images/regex_main_flow.png" src="../_images/regex_main_flow.png" />
</div>
<div class="section" id="parse">
<h2>2. 解析(parse)<a class="headerlink" href="#parse" title="永久链接至标题">¶</a></h2>
<p>解析使用词法(lexical)分析器和语法(grammar)分析器完成,  其中词法分析器主要解析正则元字符, 语法分析器解析正则语法. 解析完成后, 在内存中生成抽象语法树.</p>
<p>zre使用flex和bison来完成词法和语法分析工作.</p>
<div class="section" id="id3">
<h3>2.1 词法<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h3>
<p>编写词法分析文件, 分析正则元字符,字符组等. flex会根据此文件生成相应的C代码,
最终和其他代码一起编译.</p>
<img alt="../_images/regex_lex.png" src="../_images/regex_lex.png" />
</div>
<div class="section" id="id4">
<h3>2.2 语法<a class="headerlink" href="#id4" title="永久链接至标题">¶</a></h3>
<p>编写语法分析文件, 在上一步词法分析器生成的记号(token)流, 根据正则语法生成AST.
bison会根据此文件生成相应的C代码, 最终和其他代码一起编译.</p>
<img alt="../_images/regex_grammar.png" src="../_images/regex_grammar.png" />
</div>
<div class="section" id="id5">
<h3>2.3 抽象语法树<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h3>
<p>经过前两步解析后, 每个正则表达式都生成一棵AST, 将此AST转换成NFA, 即可用于匹配.
将多个正则表达式生成的AST进行适当的合并, 再转换成NFA, 则可以用于多模匹配.</p>
<p>zre目前的AST类型包括:</p>
<ul class="simple">
<li>普通字符树 ast_char_t</li>
<li>字符范围树 ast_range_t</li>
<li>POSIX/PERL字符组树 ast_class_t</li>
<li>重复树 ast_repeat_t</li>
<li>字符分组树 ast_group_t</li>
<li>锚点树 ast_anchor_t</li>
<li>泛型树 ast_t</li>
</ul>
<p>构造AST时, 还需要进行某些处理, 比如</p>
<ul class="simple">
<li>将ast_class_t转换为ast_group_t</li>
<li>简化某些重复树
某些重复树是无法直接编译的, 比如子表达式a{m, n}生成的重复树, 需要简化成仅含*, +, ?
这3个重复量词的树, 比如a{1, 3}需要转换成a(aa?)?</li>
</ul>
<p>这里给一个例子, 正则表达式 <cite>(a|b)*abb</cite> 生成的AST如下图所示:</p>
<img alt="../_images/regex_ast_example.png" src="../_images/regex_ast_example.png" />
</div>
</div>
<div class="section" id="compile">
<h2>3. 编译(compile)<a class="headerlink" href="#compile" title="永久链接至标题">¶</a></h2>
<div class="section" id="nfa">
<h3>3.1 构造NFA<a class="headerlink" href="#nfa" title="永久链接至标题">¶</a></h3>
<p>AST构造并简化之后, 就可以编译为NFA了.  有以下要点:</p>
<ul class="simple">
<li>对AST使用后序遍历算法(先左子树,再右子树,最后父节点)</li>
<li>使用一个辅助栈, 里面存放子NFA;每个子NFA有一个入状态和一个出状态</li>
<li>将子树编译成子NFA, 入栈; 遇到操作符(与或之类), 将子NFA出栈, 进行运算后入栈</li>
<li>到最后栈中必仅剩一个子NFA, 这就是最终的NFA</li>
<li>每个正则表达式编译成一个NFA, 并对其对应的id挂在最终NFA的匹配列表上</li>
<li>构造时e?, e*的NFA时, 弹出的子NFA的每一个节点都需要与新NFA的出状态有一个ε连接</li>
<li>进行多模编译时, 依次编译每个模式, 并将它的NFA与上一个模式生成的NFA合并(merge)</li>
</ul>
<div class="section" id="id6">
<h4>表达式与NFA的对应关系举例<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h4>
<p>普通字符a与字符组[abc]</p>
<img alt="../_images/regex_nfa_1.png" src="../_images/regex_nfa_1.png" />
<p>e1,e2两个表达式的连接和多选结构</p>
<img alt="../_images/regex_nfa_2.png" src="../_images/regex_nfa_2.png" />
<p>表达式e的匹配优先量词</p>
<img alt="../_images/regex_nfa_3.png" src="../_images/regex_nfa_3.png" />
</div>
</div>
<div class="section" id="nfadfa">
<h3>3.2 NFA转DFA<a class="headerlink" href="#nfadfa" title="永久链接至标题">¶</a></h3>
<p>使用”子集构造法”, 此算法需要以下3个针对NFA的操作例程:</p>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="83%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">操作</th>
<th class="head">描述</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ε-closure(s)</td>
<td>求从状态s开始只通过ε转换即可到达的状态集合</td>
</tr>
<tr class="row-odd"><td>ε-closure(T)</td>
<td>求可以从T中某个状态s开始, 只通过ε转换即可到达的状态集合</td>
</tr>
<tr class="row-even"><td>move(T, a)</td>
<td>求从T中某个状态s出发通过标号为a的转换到达的状态的集合</td>
</tr>
</tbody>
</table>
<p>其中s是NFA状态, T是NFA状态集合, a是输入条件.
可见DFA中每个状态实际是原NFA状态的”集合”.</p>
<p>子集构造法:</p>
<div class="line-block">
<div class="line">一开始, ε-closure(s0)唯一的DFA状态, 且它未标记;</div>
<div class="line">while(在DFA中有一个未标记状态T) {</div>
<div class="line-block">
<div class="line">标记T;</div>
<div class="line">for(每个输入a) {</div>
<div class="line-block">
<div class="line">U= ε-closure(move(T,a));</div>
<div class="line">if(U不在DFA中)</div>
<div class="line-block">
<div class="line">将U加入DFA, 且不标记;</div>
</div>
<div class="line">DFA[T, a] = U;  // 表示DFA输入为a时,T转换到U</div>
</div>
<div class="line">}</div>
</div>
<div class="line">}</div>
</div>
<p>实例: 模式 (a|b)*abb 的NFA转DFA. 设可能输入为{a, b}. DFA状态用大写字母表示.</p>
<p>构造好的NFA:</p>
<img alt="../_images/regex_nfa_example.png" src="../_images/regex_nfa_example.png" />
<p>转换步骤:</p>
<ol class="arabic">
<li><p class="first">起始状态为0, 令A=ε-closure(0) = {0, 1, 2, 4, 7}, 注意也包含它自身</p>
</li>
<li><p class="first">计算DFA[A,a] = ε-closure(move(A,a)) = ε-closure(3, 8) = {1,2,3,4,6,7,8}, 记为B;
同理, DFA[A,b] = {1,2,4,5,6,7}, 记为C</p>
</li>
<li><p class="first">对B,C继续以上过程, 最终会构造完整的DFA, 见下图</p>
<img alt="../_images/regex_dfa_example.png" src="../_images/regex_dfa_example.png" />
</li>
</ol>
</div>
<div class="section" id="id7">
<h3>3.4 消除死状态<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>当NFA转换成DFA后, DFA中可能存在”死状态”, 即进入这个状态后, 无论输入条件是什么,
都无法转换到其他状态. 这种状态会导致匹配时, 状态机陷入这一状态, 无法根据后续数据正确进行匹配.</p>
<p>若DFA[s,a]=n,n为死状态, 则计算DFA[0, a] = n2, 如果n2!=n, 则DFA[s,a] = n2;否则DFA[s,a] = 0.</p>
<img alt="../_images/regex_dead_state.png" src="../_images/regex_dead_state.png" />
</div>
<div class="section" id="dfa">
<h3>3.5 DFA最小化<a class="headerlink" href="#dfa" title="永久链接至标题">¶</a></h3>
<p>上文中构造的DFA可以经过DFA最小化算法, 将不必要的状态去除. 算法由于时间关系暂略, 以后有空会补上.</p>
</div>
<div class="section" id="id8">
<h3>3.6 DFA序列化<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>对DFA进行最小化, 生成DFAMin后, 可以将内存中的DFAMin进行序列化, 方便导出到文件中,
以后使用时导入即可, 不需要从头编译. 毕竟编译大量的正则表达式会消耗大量时间.</p>
<p>这一步比较简单, 主要是去掉DFAMin中所有指针相关的数据结构, 转换成”偏移+数组”这种”平面化(flat)”的形式.</p>
<p>当然这一步也可以在DFA最小化时一起完成. 在这里我把序列化后的DFAMin称为database.</p>
</div>
</div>
<div class="section" id="match">
<h2>4. 匹配(match)<a class="headerlink" href="#match" title="永久链接至标题">¶</a></h2>
<p>匹配可以在NFA, DFA, DFAMin或者database上进行. 由于ZRE最终构造成database, 所以仅在database上进行匹配. 前3者仅用于调试bug.</p>
<p>使用正则表达式编译而成的状态机进行模式匹配, 与使用普通字符串经AC算法编译而成的状态机相比, 并没有什么不同. 除了为兼容Hyperscan, 命中模式时报告的位置是命中位置的第一位置. 比如特征串 <cite>bcd</cite> 命中了 <cite>abcdefg</cite> , 而报告的位置是e的位置,而不是d.</p>
</div>
<div class="section" id="id9">
<h2>5. 优化<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h2>
<div class="section" id="id10">
<h3>5.1 内存<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h3>
</div>
<div class="section" id="id11">
<h3>5.2 性能<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h3>
</div>
</div>
<div class="section" id="id12">
<h2>参考<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li>&lt;&lt;精通正则表达式&gt;&gt; 第3版</li>
<li>&lt;&lt;flex与bison&gt;&gt;</li>
<li>&lt;&lt;编译原理&gt;&gt; 第2版, 第3章</li>
<li><a class="reference external" href="https://swtch.com/~rsc/regexp/regexp1.html">Regular Expression Matching Can Be Simple And Fast </a></li>
<li><a class="reference external" href="https://zhuanlan.zhihu.com/p/22554330">C++正则表达式引擎设计与实现(core)</a></li>
</ul>
<div id="container"></div>
<link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css">
<script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script>
<script>
var gitment = new Gitment({
  //id: '页面 ID', // 可选。默认为 location.href
  owner: 'zzqcn',
  repo: 'zzqcn.github.io',
  oauth: {
    client_id: 'a6db218e886efe4953d8',
    client_secret: '6ba8bd979b4c394a5df4b42abeed09e79e3b092e',
  },
})
gitment.render('container')
</script></div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="hs_intro.html" class="btn btn-neutral float-right" title="hyperscan介绍" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ac.html" class="btn btn-neutral" title="AC算法" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Zhao Ziqing.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.0',
            LANGUAGE:'zh_CN',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/translations.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>