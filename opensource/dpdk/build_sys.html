

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>18. 编译系统 &mdash; zzq&#39;s blog</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/hacks.css" type="text/css" />
  

  
        <link rel="index" title="索引"
              href="../../genindex.html"/>
        <link rel="search" title="搜索" href="../../search.html"/>
    <link rel="top" title="zzq&#39;s blog" href="../../index.html"/>
        <link rel="up" title="DPDK" href="index.html"/>
        <link rel="next" title="参考链接" href="../../net/links.html"/>
        <link rel="prev" title="17. 源码分析: Mbuf" href="mbuf.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> 赵子清技术文章
          

          
          </a>

          
            
            
              <div class="version">
                2019.03
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../design/index.html">表达与设计</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../design/rest/index.html">用reST编写文档</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/intro.html">简介</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/setup.html">安装与基本使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/setup.html#id2">安装软件包</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/setup.html#id3">项目建立</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/setup.html#conf-py">conf.py配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/setup.html#index">index页配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/setup.html#id6">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/grammar.html">reST语法介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id1">章节标题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id2">段落</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id3">行内标记</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id4">列表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id5">代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id6">超链接</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id7">图片</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id8">表格</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id9">引用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id10">脚注</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id11">提醒</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id12">替换</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/grammar.html#id13">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/style.html">修改样式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/style.html#step1">Step1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/style.html#step2">Step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/style.html#step3">Step3</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/topdf.html">生成PDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/topdf.html#xetex">方法一：使用xeTex(推荐)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/topdf.html#cjkutf8">方法二: 使用CJKutf8包 (默认)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/topdf.html#id1">终极解决办法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/doxygen.html">生成API文档</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/doxygen.html#step1">Step1</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/doxygen.html#step2">Step2</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/doxygen.html#step3">Step3</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/doxygen.html#step4">Step4</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/with_vscode.html">在Visual Studio Code中使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/with_vscode.html#id1">安装步骤</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/with_vscode.html#id2">配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/with_vscode.html#id3">使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/with_vscode.html#id4">问题记录</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/rest/add_comment.html">给github博客添加评论功能</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/add_comment.html#oauth-application">1. 注册OAuth Application</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/add_comment.html#id1">2. 编辑博客页面, 引入gitment</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/add_comment.html#id2">3. 初始化评论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/rest/add_comment.html#id3">参考链接</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../design/latex/index.html">LaTeX</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/setup.html">安装与配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../design/latex/setup.html#id2">1. 安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../design/latex/setup.html#id3">2. 卸载</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/quick_start.html">快速入门示例</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/text.html">文本与段落</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/code.html">程序代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/figure_table.html">图像与表格</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/debug.html">错误调试</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../design/latex/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../design/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../lang/index.html">开发语言</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../lang/cpp/index.html">C++ 11</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/cpp/preface.html">前言</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/cpp/preface.html#c">C++的变化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/cpp/preface.html#id2">对C++程序员的建议</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/cpp/preface.html#id3">对C程序员的建议</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/cpp/preface.html#c-11">C++11主要特性</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/cpp/preface.html#id4">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/cpp/basic.html">基本功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/cpp/oop.html">面向对象</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/cpp/stl.html">标准库</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/cpp/boost.html">boost库</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/go/index.html">Go</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/go/setup.html">环境配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/setup.html#go-get">使用代理以解决go get超时问题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/setup.html#id2">日常项目开发环境配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/setup.html#ide">IDE配置</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/go/json.html">JSON解析</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/json.html#id1">简单解析</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/json.html#id2">不确定JSON的解析</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/json.html#id3">复杂内容的解析</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/go/withc.html">C语言适配</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/go/withc.html#id1">调用C编写的动态库</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/go/books.html">学习资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/lua/lua_basic.html">lua基础</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/lua/lua_basic.html#id1">预备知识</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id2">获得lua</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id3">lua命令行</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id4">保留关键字</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id5">注释</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#chunk">Chunk</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/lua/lua_basic.html#id6">数据类型</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#string">string</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#userdata">userdata</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#thread">thread</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/lua/lua_basic.html#id7">表达式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id8">算术运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id9">关系运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id10">逻辑运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id11">连接运算符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id12">运算符优先级</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/lua/lua_basic.html#id13">语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id14">赋值</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id15">局部变量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id16">条件语句</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/lua/lua_basic.html#id17">循环语句</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/lua/lua_basic.html#id18">函数</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/shell/index.html">Linux shell编程</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/asm/index.html">汇编语言</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/arch.html">计算机体系结构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/arch.html#cpu">CPU</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/arch.html#id5">内存</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/arch.html#id6">中断</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/asm_intro.html">汇编语言简介</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id2">汇编代码的两种记法</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#centosnasm">CentOS运行nasm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id3">操作数</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id4">基本指令</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id5">指示符</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id6">输入输出</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id7">代码模板</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/asm_intro.html#id8">第一个程序</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/basic.html">语言基础</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/basic.html#id2">数据移动</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/basic.html#id3">算术运算</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/basic.html#id4">位操作</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/basic.html#id7">控制流</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/basic.html#id8">栈操作与函数调用</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/simd.html">intel SIMD指令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/debug.html">调试</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/debug.html#linux-gdb">Linux + gdb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/withc.html">与C语言互操作</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/withc.html#id1">调用约定</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/withc.html#id2">C调用汇编代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/withc.html#id3">汇编调用C代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/asm/withc.html#id4">结构体</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/asm/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/build/index.html">编译与构建</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/build/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/toml.html">TOML配置文件语言</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#id1">示例</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#id2">语法</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id3">整体约定</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id4">注释</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id5">字符串</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id6">整数</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id7">浮点数</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id8">布尔值</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id9">时间日期</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id10">数组</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id11">表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id12">内联表</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id13">表数组</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#id14">为什么我要用它呢？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#id15">目前的实现</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#libtoml">libtoml试用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id16">编译</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../lang/toml.html#id17">简单示例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/toml.html#id18">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../lang/byteorder.html">字节序与比特序</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../lang/byteorder.html#id2">字节序</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/byteorder.html#id3">比特序</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../lang/byteorder.html#id4">编写可移植代码</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../algo/index.html">数据结构与算法</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../algo/list.html">链表,栈与队列</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algo/list.html#id2">单向链表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/list.html#id3">双向链表</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/list.html#id4">侵入式数据结构</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/list.html#id5">栈</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/list.html#id6">队列</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../algo/list.html#id7">基本实现</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../algo/list.html#id8">下标的处理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../algo/list.html#id9">无锁队列</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/tree.html">树</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../algo/tree.html#id2">二叉查找树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/tree.html#avl">AVL树</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../algo/tree.html#id3">红黑树</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/hash.html">哈希表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/graph.html">图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/visit.html">遍历</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/order.html">排序</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/find.html">查找</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../algo/ac.html">AC算法</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sys/index.html">系统与库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sys/linux/index.html">Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sys/win/index.html">Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../sys/mac/index.html">macOS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../debug/index.html">调试与逆向工程</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../debug/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../../net/index.html">TCP/IP网络</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../net/tcpip/index.html">TCP/IP详解</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../net/netalgo/index.html">网络算法学</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../net/netalgo/proto_process.html">9 Protocol Processing</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/proto_process.html#id1">9.1 缓存管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/proto_process.html#crcchecksum">9.2 CRC和Checksum</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/proto_process.html#id4">9.3 通用协议处理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/proto_process.html#id5">9.4 重组</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/proto_process.html#id7">9.5 结论</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../net/netalgo/sched_packet.html">14 Scheduling Packets</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id1">14.1 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id2">14.2 拥塞控制</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id13">14.3 带宽与突发限制</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id24">14.4 多队列与优先级</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id25">14.5 资源预留协议</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id26">14.6 带宽保证</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id30">14.7 时延保证</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#scalable-fair-queuing">14.8 Scalable Fair Queuing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#dpdk">14.9 dpdk分层调度</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#diffserv">14.10 DiffServ架构介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#dpdk-qos">14.11 dpdk QoS框架</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id37">附录</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../net/netalgo/sched_packet.html#id38">参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">DPDK</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">1. 引言</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id2">1.1. 由来</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#dpdk">1.2. DPDK最佳实践</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id3">1.3. dpdk框架</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id4">1.4. dpdk的应用</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_mem_cache.html">2. 深入浅出dpdk: cache与内存</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#cache">2.1. 内存Cache简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id3">2.2. Cache地址映射与变换</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id4">2.3. Cache的写策略</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id5">2.4. Cache预取</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id8">2.5. Cache一致性</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#tlb">2.6. TLB和大页</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#ddio">2.7. DDIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#numa">2.8. NUMA系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id9">2.9. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_parallel.html">3. 深入浅出dpdk: 并行计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_sync.html">4. 深入浅出dpdk: 同步充斥机制</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id1">4.1. 原子锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id2">4.2. 读写锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id3">4.3. 自旋锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id4">4.4. 无锁机制</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_pkt_forward.html">5. 深入浅出dpdk: 报文转发</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id1">5.1. 网络处理模块分解</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id2">5.2. 转发模型</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id3">5.3. 转发算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_pkt_io.html">6. 深入浅出dpdk: PCIe与包处理IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_nic_optimize.html">7. 深入浅出dpdk: 网卡性能优化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id1">7.1. dpdk轮询模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#burst">7.2. burst收发包的思想与实现</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id2">7.3. 硬件平台的影响</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id3">7.4. 软件平台的影响</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id4">7.5. 队列长度及各种阈值的设置</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_classify.html">8. 深入浅出dpdk: 流分类与多队列</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_classify.html#id1">8.1. 多队列技术</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_classify.html#id2">8.2. 流分类</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_hw_accel.html">9. 深入浅出dpdk: 硬件加速与功能卸载</a></li>
<li class="toctree-l3"><a class="reference internal" href="eal.html">10. 源码分析: EAL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="eal.html#linuxeal">10.1. Linux环境的EAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id1">10.2. 内存机制与初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#cpu">10.3. CPU信息取得与核绑定</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#lcore">10.4. 线程/lcore的初始化与启动</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id2">10.5. 多进程应用</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id3">10.6. 其他注意事项</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id4">10.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ring.html">11. 源码分析: Ring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id1">11.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id2">11.2. 应用场景</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id3">11.3. 无锁队列操作图解</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id4">11.4. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id5">11.5. 多生产者入队</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id6">11.6. 多消费者出队</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id7">11.7. 索引计算</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id8">11.8. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mem.html">12. 源码分析: Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mem.html#id1">12.1. 内存的初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="mem.html#id4">12.2. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memseg.html">13. 源码分析: Memseg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id1">13.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id2">13.2. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id3">13.3. 初始化</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memzone.html">14. 源码分析: Memzone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id1">14.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#memzone-init">14.2. 初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id3">14.3. 内存分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id4">14.4. 内存释放</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id5">14.5. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="malloc.html">15. 源码分析: Malloc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id1">15.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id2">15.2. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#malloc-heap">15.3. malloc heap初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#malloc-heap-alloc">15.4. 内存分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id4">15.5. 内存释放</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id5">15.6. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mempool.html">16. 源码分析: Mempool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id1">16.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id2">16.2. 特性</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id4">16.3. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id5">16.4. 创建</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id6">16.5. 取出对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id7">16.6. 还回对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id8">16.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mbuf.html">17. 源码分析: Mbuf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id1">17.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id2">17.2. 原理</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id3">17.3. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id4">17.4. 分配与回收</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id8">17.5. 元信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#directindirect-mbuf">17.6. Direct和Indirect mbuf</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id9">17.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">18. 编译系统</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">18.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">18.2. 源码组织</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">18.3. 编译系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpdk-makefile">18.4. dpdk Makefile介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#root-makefile-help">18.5. 根Makefile介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#abi">18.6. ABI管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#v16-07-2">18.7. 实例：将v16.07.2编译为单个动态库</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">18.8. 参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../net/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../sec/index.html">安全</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../sec/dpi/index.html">DPI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../sec/dpi/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../sec/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../perf/index.html">性能优化</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../perf/cpu/index.html">CPU知识</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../perf/cpu/microprocessor.html">理解微处理器</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#code-and-data-a-closer-look">Code and Data: a closer look</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#meet-the-file-clerk">meet the &#8220;file clerk&#8221;</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#refining-the-model">Refining the model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#ram-when-the-registers-alone-don-t-cut-it">RAM: when the registers alone don&#8217;t cut it</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#a-closer-look-at-the-code-stream-the-program">A closer look at the code stream: the program</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#excursus-op-codes-and-machine-language">Excursus: Op codes and machine language</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#the-programming-model-and-the-isa">The programming model and the ISA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#branch-instructions">Branch instructions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/microprocessor.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/cpu/pipeline.html">理解流水线与超标量执行</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/pipeline.html#introduction">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/pipeline.html#pipelining-explained">Pipelining Explained</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/pipeline.html#superscalar-execution">Superscalar execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/pipeline.html#combining-pipelined-and-superscalar-execution">Combining pipelined and superscalar execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/pipeline.html#conclusions">Conclusions</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/cpu/bandwidth.html">理解带宽与时延</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/cpu/intel_p4.html">NetBurst: The Microarchitecture of the Pentium 4 Processor</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id1">引言</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#netburst">NetBurst微架构概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id4">时钟频率</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id6">NetBurst微架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id10">性能</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id11">结论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/cpu/intel_p4.html#id12">作者</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/cpu/glossary.html">CPU相关术语及缩略语</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../perf/intel_opt_manual/index.html">Intel优化手册</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_opt_manual/2.html">2 INTEL 64 AND IA-32 PROCESSOR ARCHITECTURES</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#skylake-server">Skylake Server</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#skylake">Skylake</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#haswell">Haswell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#haswell-e">Haswell-E</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#broadwell">Broadwell</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#sandy-bridge">Sandy Bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#ivy-bridge">Ivy Bridge</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#core-enhanced-core">Core &amp; Enhanced Core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#nehalem">Nehalem</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#id1">超线程技术</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#id2">64位架构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/2.html#simd">SIMD技术</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_opt_manual/3.html">3 一般性优化原则</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id2">3.1 性能工具</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id4">3.2 处理器全景</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id7">3.3 编程规则, 建议及调整提示</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id8">3.4 优化前端</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#execution-core">3.5 优化Execution Core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id20">3.6 优化内存访问</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#prefetch">3.7 prefetch</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#id23">3.8 浮点数的考量</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/3.html#pcie">3.9 最大化PCIe性能</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_opt_manual/7.html">7 优化cache使用</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#general-prefetch-coding-guidelines">7.1 GENERAL PREFETCH CODING GUIDELINES</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#prefetch-and-cacheability-instructions">7.2 PREFETCH AND CACHEABILITY INSTRUCTIONS</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#prefetch">7.3 PREFETCH</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#cacheability-control">7.4 CACHEABILITY CONTROL</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#memory-optimization-using-prefetch">7.5 MEMORY OPTIMIZATION USING PREFETCH</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_opt_manual/7.html#memory-optimization-using-non-temporal-stores">7.6 MEMORY OPTIMIZATION USING NON-TEMPORAL STORES</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../perf/intel_vtune/index.html">Intel VTune Amplifier</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_vtune/intro.html">介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/intro.html#id2">简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/intro.html#id3">调优方法论</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/intro.html#id4">安装</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/intro.html#id5">一般使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/intro.html#id10">参考资料</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hotspots.html">教程: 优化热点</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hotspots.html#id2">编译示例程序</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hotspots.html#vtune">创建vtune工程并运行分析</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hotspots.html#id3">分析代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hotspots.html#id4">优化代码</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html">教程: 优化硬件利用率</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html#id2">编译示例程序</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html#vtune">创建vtune工程并运行分析</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html#id3">分析代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html#id4">优化代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_hardware.html#id5">进一步分析和优化</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_vtune/tutorial_false_sharing.html">教程: 优化伪共享</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_false_sharing.html#id2">编译示例程序</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_false_sharing.html#vtune">创建vtune工程并运行分析</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_false_sharing.html#id3">分析代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tutorial_false_sharing.html#id4">优化代码</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html">调优指南: Xeon E5 v3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#intel-xeon-e5-v3-family">1 Intel Xeon E5 v3 Family</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#id1">2 性能测量的复杂性</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#id2">3 发现性能问题</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#front-end-bound">4 调优Front-End Bound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#back-end-bound">5 调优Back-End Bound</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#bad-speculation">6 调优Bad Speculation</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#retiring">7 调优Retiring</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../perf/intel_vtune/tunning_guide_e5v3.html#id12">8 附加主题</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../perf/simd_demo.html">SIMD指令编程demo</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#id1">正常代码</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#id2">一次循环计算4次</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#sse">使用SSE指令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#avx">使用AVX指令</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#id3">性能对比</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../perf/simd_demo.html#id4">更多参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../perf/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../virt/index.html">虚拟化</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../virt/vmware/index.html">VMware</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../virt/vmware/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../virt/qemu/index.html">QEMU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../virt/qemu/links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../virt/container/index.html">容器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../virt/container/links.html">参考链接</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ai/index.html">AI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../ai/books.html">学习资料</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#pattern-recognition-and-machine-learning">Pattern Recognition and Machine Learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#convex-optimization">Convex Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#deep-learning-fundamentals-an-introduction-for-beginners">Deep Learning Fundamentals: An Introduction for Beginners</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#optimization-in-operations-research">Optimization in Operations Research</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#artificial-intelligence-a-modern-approach">Artificial Intelligence: A Modern Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#deep-learning-in-natural-language-processing">Deep Learning in Natural Language Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#id2">机器学习</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../ai/books.html#deep-learning">Deep Learning</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">开源</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">DPDK</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="intro.html">1. 引言</a><ul>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id2">1.1. 由来</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#dpdk">1.2. DPDK最佳实践</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id3">1.3. dpdk框架</a></li>
<li class="toctree-l4"><a class="reference internal" href="intro.html#id4">1.4. dpdk的应用</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_mem_cache.html">2. 深入浅出dpdk: cache与内存</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#cache">2.1. 内存Cache简介</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id3">2.2. Cache地址映射与变换</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id4">2.3. Cache的写策略</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id5">2.4. Cache预取</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id8">2.5. Cache一致性</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#tlb">2.6. TLB和大页</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#ddio">2.7. DDIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#numa">2.8. NUMA系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_mem_cache.html#id9">2.9. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_parallel.html">3. 深入浅出dpdk: 并行计算</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_sync.html">4. 深入浅出dpdk: 同步充斥机制</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id1">4.1. 原子锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id2">4.2. 读写锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id3">4.3. 自旋锁</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_sync.html#id4">4.4. 无锁机制</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_pkt_forward.html">5. 深入浅出dpdk: 报文转发</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id1">5.1. 网络处理模块分解</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id2">5.2. 转发模型</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_pkt_forward.html#id3">5.3. 转发算法</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_pkt_io.html">6. 深入浅出dpdk: PCIe与包处理IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="hf_nic_optimize.html">7. 深入浅出dpdk: 网卡性能优化</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id1">7.1. dpdk轮询模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#burst">7.2. burst收发包的思想与实现</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id2">7.3. 硬件平台的影响</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id3">7.4. 软件平台的影响</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_nic_optimize.html#id4">7.5. 队列长度及各种阈值的设置</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_classify.html">8. 深入浅出dpdk: 流分类与多队列</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hf_classify.html#id1">8.1. 多队列技术</a></li>
<li class="toctree-l4"><a class="reference internal" href="hf_classify.html#id2">8.2. 流分类</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="hf_hw_accel.html">9. 深入浅出dpdk: 硬件加速与功能卸载</a></li>
<li class="toctree-l3"><a class="reference internal" href="eal.html">10. 源码分析: EAL</a><ul>
<li class="toctree-l4"><a class="reference internal" href="eal.html#linuxeal">10.1. Linux环境的EAL</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id1">10.2. 内存机制与初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#cpu">10.3. CPU信息取得与核绑定</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#lcore">10.4. 线程/lcore的初始化与启动</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id2">10.5. 多进程应用</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id3">10.6. 其他注意事项</a></li>
<li class="toctree-l4"><a class="reference internal" href="eal.html#id4">10.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="ring.html">11. 源码分析: Ring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id1">11.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id2">11.2. 应用场景</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id3">11.3. 无锁队列操作图解</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id4">11.4. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id5">11.5. 多生产者入队</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id6">11.6. 多消费者出队</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id7">11.7. 索引计算</a></li>
<li class="toctree-l4"><a class="reference internal" href="ring.html#id8">11.8. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mem.html">12. 源码分析: Memory</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mem.html#id1">12.1. 内存的初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="mem.html#id4">12.2. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memseg.html">13. 源码分析: Memseg</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id1">13.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id2">13.2. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="memseg.html#id3">13.3. 初始化</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="memzone.html">14. 源码分析: Memzone</a><ul>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id1">14.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#memzone-init">14.2. 初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id3">14.3. 内存分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id4">14.4. 内存释放</a></li>
<li class="toctree-l4"><a class="reference internal" href="memzone.html#id5">14.5. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="malloc.html">15. 源码分析: Malloc</a><ul>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id1">15.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id2">15.2. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#malloc-heap">15.3. malloc heap初始化</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#malloc-heap-alloc">15.4. 内存分配</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id4">15.5. 内存释放</a></li>
<li class="toctree-l4"><a class="reference internal" href="malloc.html#id5">15.6. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mempool.html">16. 源码分析: Mempool</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id1">16.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id2">16.2. 特性</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id4">16.3. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id5">16.4. 创建</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id6">16.5. 取出对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id7">16.6. 还回对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="mempool.html#id8">16.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="mbuf.html">17. 源码分析: Mbuf</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id1">17.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id2">17.2. 原理</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id3">17.3. 数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id4">17.4. 分配与回收</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id8">17.5. 元信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#directindirect-mbuf">17.6. Direct和Indirect mbuf</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbuf.html#id9">17.7. 参考</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">18. 编译系统</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">18.1. 概述</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">18.2. 源码组织</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">18.3. 编译系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dpdk-makefile">18.4. dpdk Makefile介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#root-makefile-help">18.5. 根Makefile介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#abi">18.6. ABI管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#v16-07-2">18.7. 实例：将v16.07.2编译为单个动态库</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id22">18.8. 参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tengine/index.html">Tengine</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tengine/intro.html">介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tengine/intro.html#tengine">Tengine的由来</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/intro.html#id2">Tengine的改进</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tengine/arch.html">架构</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id2">高性能服务器设计</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id3">进程模型</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id5">事件处理模型</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id7">模块化</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id9">请求处理机制</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/arch.html#id10">参考资料</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tengine/key_points.html">基本概念</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#connection">连接/connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#request">请求/request</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#keepalive">keepalive</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#pipeline">pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#lingering-close">lingering_close</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/key_points.html#id6">参考资料</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tengine/infrastructure.html">基础设施</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id2">日志</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id3">内存管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#cycle">cycle</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id7">字符串操作</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id12">容器</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id18">时间</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id19">网络</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id21">事件</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id22">进程</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id23">线程</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id24">模块</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tengine/infrastructure.html#id25">错误处理</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../tengine/http.html">HTTP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tengine/http.html#id1">HTTP请求处理</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../wireshark/index.html">wireshark</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../hyperscan/index.html">hyperscan</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../hyperscan/hs_intro.html">hyperscan介绍</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_intro.html#how-we-match-regular-expressions">首席工程师: How we match regular expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_intro.html#id1">源码结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_intro.html#id2">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../hyperscan/hs_pre.html">hyperscan预备知识</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_pre.html#c-11">C++ 11</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_pre.html#id5">设计模式</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_pre.html#id6">数据结构</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_pre.html#boost-library">Boost Library</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_pre.html#ragel">Ragel</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../hyperscan/hs_debug.html">hyperscan调试环境与技巧</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_debug.html#id1">编译</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_debug.html#dump">生成dump信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_debug.html#id4">加速编译过程</a></li>
<li class="toctree-l4"><a class="reference internal" href="../hyperscan/hs_debug.html#id5">生成源码文档</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../links.html">参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../misc/index.html">工具与杂项</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../misc/vim/index.html">Vim</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/vim/intro.html">简介与基本配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vim/intro.html#vim">为什么要使用vim</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vim/intro.html#id2">本系列文章的指导思想和一些约定</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vim/intro.html#id3">学习之前的基本配置和几个需要了解的基本操作</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/git/index.html">Git</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/git/basic_command.html">Git常用命令</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id2">一、新建代码库</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id3">二、配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id4">三、增加/删除文件</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id5">四、代码提交</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id6">五、分支</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id7">六、标签</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id8">七、查看信息</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id9">八、远程同步</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id10">九、撤销</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/basic_command.html#id11">十、其他</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/git/tricks.html">小技巧</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/tricks.html#shellsshgithub">shell通过SSH连接github</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/git/tricks.html#id2">在命令提示符中显示当前分支</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/vmware/index.html">虚拟机</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/vmware/static-ip.html">配置静态IP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html">减少磁盘占用空间</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html#id2">清理软件包</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html#id3">清理不用的旧内核</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html#id4">清理日志</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html#vmware">使用VMware磁盘工具回收磁盘空间</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/reduce-disk-size.html#id5">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/vmware/misc.html">杂项</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/vmware/misc.html#id2">解决启动黑屏问题</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/cmake.html">CMake使用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#hello-world">Hello World</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#id1">清理编译后留下的文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#id2">处理多个目录</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#id3">处理第3方依赖库</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#debugrelease">生成debug和release版的程序</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cmake.html#id4">参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/clib-abi.html">解决C/C++依赖库不兼容的问题</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/clib-abi.html#id1">问题引入与分析</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/clib-abi.html#id3">解决问题</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/clib-abi.html#id7">参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/shadowsocks.html">VPS+Shadowsocks科学上网</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/shadowsocks.html#vps">购买VPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/shadowsocks.html#shadowsocks">安装,配置shadowsocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/shadowsocks.html#id2">服务器端</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/shadowsocks.html#id3">客户端</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/shadowsocks.html#id4">其他技巧</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/shadowsocks.html#id5">对不同网站使用不同的连接方式: 直接/代理</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/shadowsocks.html#window">Window下令无法设置代理的应用程序使用代理</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/shadowsocks.html#id6">参考链接</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/patch.html">补丁工具patch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/patch.html#id1">1 为单个文件生成补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/patch.html#id2">2 为多个文件生成补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/patch.html#id3">3 打补丁</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/patch.html#id4">4 示例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/libpcap.html">libpcap使用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#id1">创建句柄</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-open-offline">pcap_open_offline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-dump-open">pcap_dump_open</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#id2">关闭句柄</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-close">pcap_close</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-dump-close">pcap_dump_close</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#packet">读取packet</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-open-pcap-dispatch">pcap_open/pcap_dispatch</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#id3">设置选项</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-set-promisc">pcap_set_promisc</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#id4">其他</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-breakloop">pcap_breakloop</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-file">pcap_file</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/libpcap.html#pcap-dump-file">pcap_dump_file</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/libpcap.html#id5">参考</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/cunit.html">CUnit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/cunit.html#cunit-2-1-3">编译安装CUnit-2.1-3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/centos.html">CentOS应用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/centos.html#centos7-3minimalc-c">CentOS7.3Minimal从零配置C/C++开发环境</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/centos.html#failed-to-start-lsb-bring-up-down-networking">网络配置失败,显示Failed to start LSB: Bring up/down networking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/centos.html#centoswindows">共享CentOS虚拟机上的文件给Windows本机访问</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/centos.html#pip">安装pip</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/ubuntu.html">Ubuntu应用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#id1">14.04更换阿里云源</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#youcompleteme">安装YouCompleteMe插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#cpu">隔离某些cpu核心</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#vmware-workstationubuntu-server">VMware Workstation中的Ubuntu Server虚拟机重启后共享文件夹消失</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#cannot-set-lc-ctype-to-default-locale-no-such-file-or-directory">Cannot set LC_CTYPE to default locale: No such file or directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#man">man文档不全</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/ubuntu.html#id2">修改系统对消息队列的默认限制</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/xiaomi-router.html">小米路由器开发</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/xiaomi-router.html#rom">用ROM刷机</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/xiaomi-router.html#ssh">开启SSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/xiaomi-router.html#id2">交叉编译环境搭建</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/xiaomi-router.html#id3">交叉编译库或工具</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/xiaomi-router.html#libpcap">编译libpcap</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/xiaomi-router.html#helloworld">编译helloworld</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/xiaomi-router.html#gdb">编译gdb</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/xiaomi-router.html#id4">其他</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/xiaomi-router.html#id5">在小米路由器上部署静态网页</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/qemu.html">QEMU模拟器</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../misc/qemu.html#id2">安装软件包</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/qemu.html#id3">用户模式</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../misc/qemu.html#id4">系统模式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../misc/qemu.html#id5">一般使用</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/qemu.html#id6">配置网络</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../misc/qemu.html#gdb">远程gdb调试</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../misc/config-links.html">配置文件-参考链接</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../hobby/index.html">兴趣爱好</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../hobby/video_trick.html">视频制作相关小技巧</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/video_trick.html#b">如何下载B站视频，或者用微博发的视频？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/video_trick.html#mac">Mac系统下应该用什么软件做视频编辑？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/video_trick.html#mac-gif">Mac系统如何做动图（gif）？</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/video_trick.html#gif-fcpx">我有一些动图（gif），怎么将它们导入到fcpx？直接导入发现它们不动了啊！</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/video_trick.html#id2">Mac系统如何录制系统自己发出的声音，比如我正在听一首很好听的歌但是不方便下载它？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../hobby/ffmpeg.html">ffmpeg应用</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/ffmpeg.html#id1">常用技巧</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../hobby/ffmpeg.html#id2">参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutme.html">关于我</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">赵子清技术文章</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../net/index.html">TCP/IP网络</a> &raquo;</li>
        
          <li><a href="index.html">DPDK</a> &raquo;</li>
        
      <li>18. 编译系统</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>18. 编译系统<a class="headerlink" href="#id1" title="永久链接至标题">¶</a></h1>
<p><em>本文更新于 2018.04.28</em></p>
<div class="section" id="id2">
<h2>18.1. 概述<a class="headerlink" href="#id2" title="永久链接至标题">¶</a></h2>
<p>本文主要介绍dpdk的源码组织及编译系统，这些内容对于了解dpdk源码、
根据需要裁剪dpdk功能、编译dpdk本身或基于dpdk的应用程序等都有帮助。</p>
<p>文后给出了对dpdk编译系统进行修改以达成某些特定需求的实例。</p>
</div>
<div class="section" id="id3">
<h2>18.2. 源码组织<a class="headerlink" href="#id3" title="永久链接至标题">¶</a></h2>
<p>dpdk源码包可以在 <a class="reference external" href="http://www.dpdk.org/download">dpdk.org</a> 下载。2.2版本后，版本号直接变为16.04。</p>
<p>git方式获取源码（只读）:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>git clone git://dpdk.org/dpdk , 或
git clone http://dpdk.org/git/dpdk
</pre></div>
</div>
<p>RTE_SDK是编译dpdk之前需要设置的一个环境变量，其值是dpdk源码包解压后的主目录。以下就以&lt;RTE_SDK&gt;表示dpdk源码主目录:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>&lt;RTE_SDK&gt;
├── app           # 一些测试程序
├── buildtools    # XXX
├── config        # 配置文件
├── doc           # rst文档
├── drivers       # 设备驱动程序(poll-mode)
├── examples      # 示例程序
├── GNUmakefile   # Head Makefile for compiling rte SDK
├── lib           # dpdk库
├── LICENSE.GPL
├── LICENSE.LGPL
├── MAINTAINERS   # dpdk维护者信息列表
├── Makefile      # 无用
├── mk            # lib和app的Makefiles
├── pkg           # 软件包相关（？）
├── README        # 简要说明
├── scripts       # 脚本
└── tools         # 辅助工具/脚本
</pre></div>
</div>
<div class="section" id="config">
<h3>18.2.1. config<a class="headerlink" href="#config" title="永久链接至标题">¶</a></h3>
<p>这里的配置文件用于对不同的编译目标（target）进行配置，包括是否编译某些库，调试选项是否开启等。其中 <code class="docutils literal"><span class="pre">common_base</span></code> 文件非常重要，其中的内容需要非常熟悉。</p>
</div>
<div class="section" id="mk">
<h3>18.2.2. mk<a class="headerlink" href="#mk" title="永久链接至标题">¶</a></h3>
<p>这里的Makefile文件（后缀.mk）对应多个target、源码种类或编译选项。例如rte.lib.mk用于编译&lt;RTE_SDK&gt;/lib，rte.combinedlib.mk用于将dpddk编译为单个组合库，rte.app.mk用于编译基于dpdk的应用程序。</p>
</div>
<div class="section" id="drivers">
<h3>18.2.3. drivers<a class="headerlink" href="#drivers" title="永久链接至标题">¶</a></h3>
<p>poll模式的设备驱动源码，例如10GbE，40GbE，PCAP驱动等。</p>
</div>
<div class="section" id="lib">
<h3>18.2.4. lib<a class="headerlink" href="#lib" title="永久链接至标题">¶</a></h3>
<p>dpdk库源码，每个库一个目录。例如EAL, mbuf, mempool, ring, hash等。</p>
</div>
<div class="section" id="tools">
<h3>18.2.5. tools<a class="headerlink" href="#tools" title="永久链接至标题">¶</a></h3>
<p>一些有用的工具:</p>
<ul class="simple">
<li><strong>cpu_layout.py</strong> 显示JCPU socket/lcore布局信息</li>
<li><strong>dpdk-devbind.py</strong> dpdk设备驱动绑定</li>
<li><strong>dpdk-pmdinfo.py</strong> dump a PMDs hardware support info</li>
<li><strong>dpdk-setup.sh</strong> dpdk编译/配置脚本</li>
</ul>
</div>
<div class="section" id="app">
<h3>18.2.6. app<a class="headerlink" href="#app" title="永久链接至标题">¶</a></h3>
<p>主要是一些测试程序源码，可用于测试dpdk编译和配置有没有问题。</p>
</div>
<div class="section" id="examples">
<h3>18.2.7. examples<a class="headerlink" href="#examples" title="永久链接至标题">¶</a></h3>
<p>示例程序，对学习如何使用dpdk非常有帮助。见
<a class="reference external" href="http://dpdk.org/doc/guides/sample_app_ug/index.html">文档</a> 。</p>
</div>
</div>
<div class="section" id="id5">
<h2>18.3. 编译系统<a class="headerlink" href="#id5" title="永久链接至标题">¶</a></h2>
<p>本节描述dpdk所采用的编译系统，以及一些约束条件和机制。</p>
<p>涉及dpdk的编译工作主要有两类：</p>
<ul class="simple">
<li>编译dpdk库和示例程序，编译系统生成头文件，二进制库文件和示例程序</li>
<li>编译外部程序或库，它们使用已安装的dpdk</li>
</ul>
<div class="section" id="dpdk">
<h3>18.3.1. 编译dpdk<a class="headerlink" href="#dpdk" title="永久链接至标题">¶</a></h3>
<p>最简单的编译方法:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>确保各辅助脚本, 如buildtools子目录下的shell脚本具有可执行权限
切换到root权限
cd &lt;dpdk源码主目录&gt;
make config T=x86_64-native-linuxapp-gcc &amp;&amp; make
</pre></div>
</div>
<p>参考 doc/build-sdk-quick.txt.
这将以默认配置编译dpdk, 编译生成的目录为build, 各种库编译为分离的静态库.</p>
<p>以下是详细编译方法.</p>
<p>在编译dpdk前，需要设置RTE_SDK环境变量，以及&#8221;arch-machine-execenv-toolchain&#8221;组成的编译目标（target）。比如，要使用gcc为x86_64架构native处理器，linux环境编译dpdk，编译目录同target:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>export RTE_TARGET=x86_64-native-linuxapp-gcc
cd $RTE_SDK
make config T=$RTE_TARGET O=$RTE_TARGET
</pre></div>
</div>
<p>其中 <code class="docutils literal"><span class="pre">O=</span></code> 指定RTE_OUTPUT, 即编译输出目录.</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">RTE_TARGET实际上是dpdk编译系统的一个环境变量，应设置成
arch-machine-execenv-toolchain形式，输出目录也应该设置此值，
因为输出目录$(RTE_OUTPUT)默认是build，而编译外部程序时，链接
dpdk的路径是RTE_SDK_BIN=$RTE_SDK/$RTE_TARGET, 如果RTE_OUTPUT
和RTE_TARGET不一致，会发生找不到库的错误. 更多环境变量见X.X节</p>
</div>
<p>完成后，将在&lt;RTE_SDK&gt;生成$RTE_OUTPUT子目录，其中包含对应此target的配置文件Makefile等。接着可以进行编译(这里$RTE_TARGET等于$RTE_OUTPUT):</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>cd $RTE_TARGET
make
</pre></div>
</div>
<p>或者:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>make O=$RTE_TARGET
</pre></div>
</div>
<p>编译完成后，编译目录内容为:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>x86_64-native-linuxapp-gcc
├── .config  # 针对此target生成的配置文件
├── app      # 生成的自带应用程序
├── build    # 编译期间的临时文件
├── include  # 头文件（链接）
├── kmod     # 生成的内核驱动
├── lib      # 生成的dpdk库文件
└── Makefile # 生成的Makefile
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>18.3.2. 编译外部程序<a class="headerlink" href="#id6" title="永久链接至标题">¶</a></h3>
<p>假设外部程序源码在/home/zzq/helloworld目录。
在此目录下的Makefile中，需要包含dpdk的一些.mk文件，如$RTE_SDK/mk/rte.vas.mk，$RTE_SDK/mk/rte.app.mk等。具体见
<a class="reference external" href="http://dpdk.org/doc/guides/prog_guide/build_app.html">Building Your Own Application</a></p>
<p>首先确保设置了RTE_SDK和RTE_TARGET环境变量:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>export RTE_SDK=/home/zzq/dpdk-stable-16.07.2
export RTE_TARGET=x86_64-native-linuxapp-gcc
cd /home/zzq/helloworld
make
</pre></div>
</div>
<p>编译完成后，生成的文件位于/home/zzq/helloworld/build目录。Makefile写法之类可以参考$RTE_SDK/examples目录中的各示例。</p>
</div>
</div>
<div class="section" id="dpdk-makefile">
<h2>18.4. dpdk Makefile介绍<a class="headerlink" href="#dpdk-makefile" title="永久链接至标题">¶</a></h2>
<div class="section" id="id7">
<h3>18.4.1. 一般规则<a class="headerlink" href="#id7" title="永久链接至标题">¶</a></h3>
<p>dpdk Makefile一般都是遵循以下方案：</p>
<ol class="arabic simple">
<li>在开头include $(RTE_SDK)/mk/rte.vars.mk</li>
<li>定义某些特定变量</li>
<li>根据需求，include $(RTE_SDK)mk/rte.XYZ.mk，XYZ可能是app,lib,extlib,obj等等，取决于要编译的目标文件类型</li>
<li>包含用户自定义的规则和变量</li>
</ol>
<p>以下是一个极简示例（取自examples/helloworld）:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(RTE_SDK),)
$(error &quot;Please define RTE_SDK environment variable&quot;)
endif

# Default target, can be overriden by command line or environment
RTE_TARGET ?= x86_64-native-linuxapp-gcc

include $(RTE_SDK)/mk/rte.vars.mk

# binary name
APP = helloworld

# all source are stored in SRCS-y
SRCS-y := main.c

CFLAGS += -O3
CFLAGS += $(WERROR_FLAGS)

include $(RTE_SDK)/mk/rte.extapp.mk
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>18.4.2. 类型<a class="headerlink" href="#id8" title="永久链接至标题">¶</a></h3>
<p>根据所包含的.mk文件的不同，Makefile有不同的角色。不可能用同一个Makefile编译库和应用程序，而必须得使用2个Makefile。</p>
<p>用户的Makefile都应包含rte.vars.mk。</p>
<div class="section" id="id9">
<h4>18.4.2.1. 应用程序<a class="headerlink" href="#id9" title="永久链接至标题">¶</a></h4>
<p>以下Makefile用于生成二进制程序：</p>
<ul class="simple">
<li>rte.app.mk: dpdk包含的应用程序</li>
<li>rte.extapp.mk: 外部应用程序</li>
<li>rte.hostapp.mk: 编译dpdk所需的工具</li>
</ul>
</div>
<div class="section" id="id10">
<h4>18.4.2.2. 库<a class="headerlink" href="#id10" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li>rte.lib.mk: dpdk库</li>
<li>rte.extlib.mk: 外部库</li>
<li>rte.hostlib.mk: dpdk中的host库</li>
</ul>
</div>
<div class="section" id="install">
<h4>18.4.2.3. install<a class="headerlink" href="#install" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li>rte.install.mk: 不编译任何东西，只用于创建链接或将文件拷贝到安装目录</li>
</ul>
</div>
<div class="section" id="id11">
<h4>18.4.2.4. 内核模块<a class="headerlink" href="#id11" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li>rte.module.mk: 编译dpdk中的内核模块</li>
</ul>
</div>
<div class="section" id="objects">
<h4>18.4.2.5. objects<a class="headerlink" href="#objects" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li>rte.obj.mk: 将编译dpdk生成的多个.o文件合并成一个</li>
<li>rte.extobj.mk: 将编译外部代码生成的多个.o文件合并成一个</li>
</ul>
</div>
<div class="section" id="id12">
<h4>18.4.2.6. 杂项<a class="headerlink" href="#id12" title="永久链接至标题">¶</a></h4>
<ul class="simple">
<li>rte.doc.mk: 编译dpdk文档</li>
<li>rte.gnuconfigure.mk: 编译基于configure的应用程序</li>
<li>rte.subdir.mk: 编译dpdk的多个子目录</li>
</ul>
</div>
</div>
<div class="section" id="id13">
<h3>18.4.3. 常用变量<a class="headerlink" href="#id13" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><strong>RTE_SDK</strong> dpdk源码主目录的绝对路径</li>
<li><strong>RTE_SRCDIR</strong> 源码根目录，编译dpdk时等于$RTE_SDK，编译外部程序时指向外部程序源码的根目录</li>
<li><strong>RTE_OUTPUT</strong> 输出文件路径，默认是$(RTE_SDK)/build，但可以通过命令行中的 <code class="docutils literal"><span class="pre">O=</span></code> 选项来指定</li>
<li><strong>RTE_TARGET</strong> 用于识别当前编译目标的字符串，格式是 <code class="docutils literal"><span class="pre">arch-machine\</span>
<span class="pre">-execenv-toolchain</span></code></li>
<li><strong>RTE_SDK_BIN</strong> 引用$(RTE_SDK)/$(RTE_TARGET)。注意，编译基于dpdk的外部程序时会通过$RTE_SDK_BIN来引用dpdk库，因此编译dpdk时，最好通过O=$(RTE_TARGET)指定输出目录到$(RTE_TARGET)，而不是&#8221;build&#8221;,&#8221;mybuild&#8221;等目录</li>
<li><strong>RTE_ARCH</strong> 定义CPU架构(i686,x86_64等)，它与CONFIG_RTE_ARCH值相同，但没有两边的&#8221;号</li>
<li><strong>RTE_MACHINE</strong> 定义machine(native, armv8a等)，它与CONFIG_RTE_MACHINE值相同，但没有两边的&#8221;号</li>
<li><strong>RTE_TOOLCHAIN</strong> 定义编译工具链(gcc,icc,clang等)，它与CONFIG_RTE_TOOLCHAIN值相同，但没有两边的&#8221;号</li>
<li><strong>RTE_EXEC_ENV</strong> 定义执行环境(linuxapp,bsdapp等)，它与CONFIG_RTE_EXEC_ENV值相同，但没有两边的&#8221;号</li>
<li><strong>RTE_KERNELDIR</strong> 包含用于编译内核模块的内核源码的绝对路径，默认是/lib/modules/$(shell uname -r)/build，当目标机器也是编译机器时是没问题的，否则要在目标机器上重新编译</li>
<li><strong>RTE_DEVEL_BUILD</strong> Stricter options (stop on warning). It defaults to y in a git tree.</li>
</ul>
</div>
<div class="section" id="makefile">
<h3>18.4.4. 仅可以在Makefile中设置的变量<a class="headerlink" href="#makefile" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><strong>VPATH</strong> 源码搜索路径列表，RTE_SRCDIR默认会包含在其中</li>
<li><strong>CFLAGS</strong> C编译选项</li>
<li><strong>LDFLAGS</strong> 链接选项</li>
<li><strong>ASFLAGS</strong> 汇编选项</li>
<li><strong>CPPFLAGS</strong> C预处理器选项（仅用于汇编.S文件）</li>
<li><strong>LDLIBS</strong> 要链接的库列表</li>
<li><strong>SRC-y</strong> 源文件列表（.c,.S或.o），这些文件必须在VPATH中</li>
<li><strong>INSTALL-y-$(INSTPATH)</strong> 要安装到$(INSTPATH)中的文件列表，这些文件必须在VPATH中，且会被拷贝到$(RTE_OUTPUT)/$(INSTPATH)</li>
<li><strong>SYMLINK-y-$(INSTPATH)</strong> 要安装到$(INSTPATH)中的文件列表，这些文件必须在VPATH中，且会被符号链接到$(RTE_OUTPUT)/$(INSTPATH)</li>
<li><strong>PREBUILD</strong> 编译之前需要执行的动作</li>
<li><strong>POSTBUILD</strong> 主要编译之后需要执行的动作</li>
<li><strong>PREINSTALL</strong> 安装之前需要执行的动作</li>
<li><strong>POSTINSTALL</strong>  安装之后需要执行的动作</li>
<li><strong>PRECLEAN</strong> 在清理之前需要执行的动作</li>
<li><strong>POSTCLEAN</strong> 在清理之后需要执行的动作</li>
<li><strong>DEPDIR-y</strong> 仅用于确定当前目录的编译是否依赖其他目录的编译，并行编译需要此变量</li>
</ul>
</div>
<div class="section" id="id14">
<h3>18.4.5. 仅可以在命令行中设置的变量<a class="headerlink" href="#id14" title="永久链接至标题">¶</a></h3>
<p>见 <a class="reference internal" href="#root-makefile-help"><span class="std std-ref">根Makefile介绍</span></a> 和 <a class="reference external" href="http://dpdk.org/doc/guides/prog_guide/ext_app_lib_make_help.html">External Application/Library Makefile Help </a> 。</p>
<ul>
<li><p class="first"><strong>WERROR_CFLAGS</strong> 默认设置为依赖于编译器的某特定值，推荐用法如:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>CFLAGS += $(WERROR_CFLAGS)
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id15">
<h3>18.4.6. 可以在Makefile或命令行中设置的变量<a class="headerlink" href="#id15" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><strong>CFLAGS_my_file.o</strong> 额外的my_file.c的C编译选项</li>
<li><strong>LDFLAGS_my_app</strong> 额外的my_app的链接选项</li>
<li><strong>EXTRA_CFLAGS</strong> 编译时添加到CFLAGS之后</li>
<li><strong>EXTRA_LDFLAGS</strong> 链接时添加到LDFLAGS之后</li>
<li><strong>EXTRA_LDLIBS</strong> 链接时添加到LDLIBS之后</li>
<li><strong>EXTRA_ASFLAGS</strong> 汇编时添加到ASFLAGS之后</li>
<li><strong>EXTRA_CPPFLAGS</strong> 添加到CPPFLAGS之后</li>
</ul>
</div>
</div>
<div class="section" id="root-makefile-help">
<span id="id16"></span><h2>18.5. 根Makefile介绍<a class="headerlink" href="#root-makefile-help" title="永久链接至标题">¶</a></h2>
<p>dpdk编译系统提供了一个包含多个target的根Makefile，这些target包括config, build, test, install及其他。此Makefile应该是&lt;RTE_SDK&gt;/mk/rte.sdkroot.mk。</p>
<div class="section" id="config-target">
<h3>18.5.1. config target<a class="headerlink" href="#config-target" title="永久链接至标题">¶</a></h3>
<p>编译此target必须通过 <code class="docutils literal"><span class="pre">T=</span></code> 指定target名称，所有可用的target名称见&lt;RTE_SDK&gt;/config/defconfig_XXX。还可以通过 <code class="docutils literal"><span class="pre">O=</span></code> 指定输出目录，默认目录是build。示例:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>export RTE_TARGET=x86_64-native-linuxapp-gcc
make config T=$RTE_TARGET O=$RTE_TARGET
</pre></div>
</div>
<p>完成后，将在输出目录创建配置文件和Makefile等。</p>
</div>
<div class="section" id="build-target">
<h3>18.5.2. build target<a class="headerlink" href="#build-target" title="永久链接至标题">¶</a></h3>
<p>build target也支持输出目录的可选项，即 <code class="docutils literal"><span class="pre">O=</span></code> ，默认目录是build。</p>
<ul class="simple">
<li>all, 或仅make 在make config创建的输出目录中编译dpdk</li>
<li>clean 清理</li>
<li>%_sub 仅编译某个子目录。例： <code class="docutils literal"><span class="pre">make</span> <span class="pre">lib/librte_eal_sub</span> <span class="pre">O=$RTE_TARGET</span></code></li>
<li>%_clean 仅清理某个子目录。例： <code class="docutils literal"><span class="pre">make</span> <span class="pre">lib/librte_eal_clean</span> <span class="pre">O=$RTE_TARGET</span></code></li>
</ul>
<p>以上target都可以带 <code class="docutils literal"><span class="pre">O=</span></code> 选项。</p>
</div>
<div class="section" id="install-target">
<h3>18.5.3. install target<a class="headerlink" href="#install-target" title="永久链接至标题">¶</a></h3>
<p>安装编译后的文件。例： <code class="docutils literal"><span class="pre">make</span> <span class="pre">install</span> <span class="pre">DESTDIR=myinstall</span> <span class="pre">prefix=/usr</span></code></p>
<p>注意需要指定DESTDIR。</p>
</div>
<div class="section" id="test-target">
<h3>18.5.4. test target<a class="headerlink" href="#test-target" title="永久链接至标题">¶</a></h3>
<p>启动自动测试（需要在编译前将config/common_base中的 CONFIG_RTE_APP_TEST改为y)。例： <code class="docutils literal"><span class="pre">make</span> <span class="pre">test</span> <span class="pre">O=$RTE_TARGET</span></code></p>
</div>
<div class="section" id="target">
<h3>18.5.5. 文档target<a class="headerlink" href="#target" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>doc 生成API和指南文档</li>
<li>doc-api-html 生成html格式的API文档(基于Doxygen)</li>
<li>doc-guides-html 生成html格式的指南文档</li>
<li>doc-guides-pdf 生成pdf格式的指南文档</li>
</ul>
</div>
<div class="section" id="deps-target">
<h3>18.5.6. deps target<a class="headerlink" href="#deps-target" title="永久链接至标题">¶</a></h3>
<ul>
<li><p class="first">depdirs 此target由make config隐式调用，用户一般不需要显式调用，除非Makefile中的DEPDIRS-y变量发生了变化。执行后会生成$RTE_OUTPUT/.depdirs文件。</p>
</li>
<li><p class="first">depgraph 此命令生成依赖项的dot graph，可用于调试循环引用问题。</p>
<blockquote>
<div><p>示例:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>make depgraph O=$RTE_TARGET &gt; /tmp/graph.dot &amp;&amp; dotty /tmp/graph.dot
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<p>有关dot和dotty可参考： <a class="reference external" href="http://hoagland.org/Dot.html">http://hoagland.org/Dot.html</a></p>
</div>
<div class="section" id="id17">
<h3>18.5.7. 杂项target<a class="headerlink" href="#id17" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li>help 显示编译帮助</li>
</ul>
</div>
<div class="section" id="id18">
<h3>18.5.8. 其他命令行变量<a class="headerlink" href="#id18" title="永久链接至标题">¶</a></h3>
<ul class="simple">
<li><strong>V=</strong> verbose模式（V=y），显示完整的编译命令，包括一些中间命令</li>
<li><strong>D=</strong> 依赖性调试</li>
<li>EXTRA_CFLAGS=, EXTRA_LDFLAGS=, EXTRA_LDLIBS=, EXTRA_ASFLAGS=, EXTRA_CPPFLAGS=</li>
<li><strong>CROSS=</strong> Specify a cross toolchain header that will prefix all gcc/binutils applications. This only works when using gcc.</li>
</ul>
</div>
<div class="section" id="debug">
<h3>18.5.9. 编译Debug版本<a class="headerlink" href="#debug" title="永久链接至标题">¶</a></h3>
<p>修改EXTRA_CFLAGS环境变量即可:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>export EXTRA_CFLAGS=&#39;-O0 -g&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="abi">
<h2>18.6. ABI管理<a class="headerlink" href="#abi" title="永久链接至标题">¶</a></h2>
<div class="section" id="id19">
<h3>18.6.1. 什么是ABI<a class="headerlink" href="#id19" title="永久链接至标题">¶</a></h3>
<p>XXX</p>
</div>
<div class="section" id="dpdk-abi">
<h3>18.6.2. DPDK ABI策略<a class="headerlink" href="#dpdk-abi" title="永久链接至标题">¶</a></h3>
<p>XXX 见 <a class="reference external" href="http://dpdk.org/doc/guides/contributing/versioning.html#the-dpdk-abi-policy">DPDK ABI policy</a></p>
</div>
<div class="section" id="id20">
<h3>18.6.3. ABI宏及示例<a class="headerlink" href="#id20" title="永久链接至标题">¶</a></h3>
<p>库中的符号（symbol）不仅提供了API，还提供了函数名、返回值和参数这些调用约定。有时候在新版本中需要修改这些函数，此时，应在一段时间内与旧版本保持向后兼容。</p>
<p>头文件 <code class="docutils literal"><span class="pre">lib/librte_compat/rte_compat.h</span></code> 提供了向后兼容所需要的宏，这些宏与文件 <code class="docutils literal"><span class="pre">rte_&lt;library&gt;_version.map</span></code> 结合使用，以支持在同一个动态库中提供同一符号的多个版本，这样一来，依赖此动态库的旧版本的程序就不需要重新编译。</p>
<p>这些宏包括：</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">VERSION_SYMBOL(b,</span> <span class="pre">e,</span> <span class="pre">n)</span></code> 创建一个符号版本表项，绑定版本化符号<code class="docutils literal"><span class="pre">b&#64;DPDK_n</span></code> 到内部函数 <code class="docutils literal"><span class="pre">b_e</span></code></li>
<li><code class="docutils literal"><span class="pre">BIND_DEFAULT_SYMBOL(b,</span> <span class="pre">e,</span> <span class="pre">n)</span></code> 创建一个符号版本项，指导链接器将符号 <code class="docutils literal"><span class="pre">b</span></code> 绑定到内部函数 <code class="docutils literal"><span class="pre">b_e</span></code></li>
<li><code class="docutils literal"><span class="pre">MAP_STATIC_SYMBOL(f,</span> <span class="pre">p)</span></code> 声明原型 <code class="docutils literal"><span class="pre">f</span></code> ，并将它映射到完整函数
<code class="docutils literal"><span class="pre">p</span></code> 。这样的话，若某符号版本化（有多个版本），它仍可被映射回公共符号名</li>
</ul>
<p>下面是一些实例。</p>
<div class="section" id="api">
<h4>18.6.3.1. 更新API<a class="headerlink" href="#api" title="永久链接至标题">¶</a></h4>
<p>假设老版本函数为</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Create an acl context object for apps to manipulate</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">rte_acl_ctx</span> <span class="o">*</span>
<span class="nf">rte_acl_create</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">rte_acl_param</span> <span class="o">*</span><span class="n">param</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>现在需要修改此API，给acl context设置debug标志：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Create an acl context object for apps to manipulate</span>
<span class="cm"> */</span>
<span class="k">struct</span> <span class="n">rte_acl_ctx</span> <span class="o">*</span>
<span class="nf">rte_acl_create</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="n">rte_acl_param</span> <span class="o">*</span><span class="n">param</span><span class="p">,</span> <span class="kt">int</span> <span class="n">debug</span><span class="p">)</span>
<span class="p">{</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>如果不使用ABI宏直接编译，那么链接此动态库的旧程序将不得不修改代码。而使用ABI宏可以让多个函数映射到同一符号，让新版动态库保持向后兼容，旧程序不需要修改代码。</p>
<p>首先需要修改此库对应的.map文件，原本的文件内容如下（rte_acl_version.map）:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>DPDK_2.0 {
    global:

    rte_acl_add_rules;
    rte_acl_build;
    rte_acl_classify;
    rte_acl_classify_alg;
    rte_acl_classify_scalar;
    rte_acl_create;
    rte_acl_dump;
    rte_acl_find_existing;
    rte_acl_free;
    rte_acl_ipv4vlan_add_rules;
    rte_acl_ipv4vlan_build;
    rte_acl_list_dump;
    rte_acl_reset;
    rte_acl_reset_rules;
    rte_acl_set_ctx_classify;

    local: *;
};
</pre></div>
</div>
<p>需要修改为:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>DPDK_2.0 {
    global:

    rte_acl_add_rules;
    rte_acl_build;
    rte_acl_classify;
    rte_acl_classify_alg;
    rte_acl_classify_scalar;
    rte_acl_create;
    rte_acl_dump;
    rte_acl_find_existing;
    rte_acl_free;
    rte_acl_ipv4vlan_add_rules;
    rte_acl_ipv4vlan_build;
    rte_acl_list_dump;
    rte_acl_reset;
    rte_acl_reset_rules;
    rte_acl_set_ctx_classify;

    local: *;
};

DPDK_2.1 {
    global:
    rte_acl_create;

} DPDK_2.0;
</pre></div>
</div>
<p>增加的部分告诉链接器新增了一个版本节点（version node）DPDK_2.1，它包含符号rte_acl_create，并继承节点DPDK_2.0的符号。当DPDK被编译为动态库时，此列表会直接翻译成导出符号表。</p>
<p>接下来，需要在代码中指定哪个版本映射哪个rte_acl_create。首先，需要改变原函数的定义，使其命名唯一且不和公用符号名冲突:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>struct rte_acl_ctx *
-rte_acl_create(const struct rte_acl_param *param)
+rte_acl_create_v20(const struct rte_acl_param *param)
{
    size_t sz;
    struct rte_acl_ctx *ctx;
    ...
</pre></div>
</div>
<p>注意符号的基本名称（指的应该是rte_acl_create_v20中的rte_acl_create前缀）保持不变，这对用于符号版本化的宏有好处。接着，把新符号名映射到版本节点2.0中的原始符号名。紧接着此函数的定义，添加一行代码:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>VERSION_SYMBOL(rte_acl_create, _v20, 2.0);
</pre></div>
</div>
<p>记得把rte_compat.h头文件包含到.c源码文件中。上面的宏指导链接器创建一个新符号 <code class="docutils literal"><span class="pre">rte_acl_create&#64;DPDK_2.0</span></code> ，它匹配老版本中的符号，但指向上一步我们新命名的函数。到此为止，已经把原始的rte_acl_create符号映射到原始函数，只不过改了一个新名字。</p>
<p>然后，需要创建符号的2.1版本。实现的新版函数使用一个新的函数名，带不同的后缀:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>struct rte_acl_ctx *
rte_acl_create_v21(const struct rte_acl_param *param, int debug);
{
    struct rte_acl_ctx *ctx = rte_acl_create_v20(param);

    ctx-&gt;debug = debug;

    return ctx;
}
</pre></div>
</div>
<p>同样地，需要把此函数映射到符号 <code class="docutils literal"><span class="pre">rte_acl_create&#64;DPDK_2.1</span></code> 。修改此API原型所在的头文件，添加版本宏，通知调用此函数的程序在重新链接时，默认的rte_acl_create符号应指向新版本函数:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>struct rte_acl_ctx *
-rte_acl_create(const struct rte_acl_param *param);
+rte_acl_create(const struct rte_acl_param *param, int debug);
+BIND_DEFAULT_SYMBOL(rte_acl_create, _v21, 2.1);
</pre></div>
</div>
<p>BIND_DEFAULT_SYMBOL宏显式地告诉包含此头文件的程序链接函数rte_acl_create_v21并对其应用版本节点DPDK_2.1。这种方法比重新实现原符号名更显式和灵活。</p>
<p>最后，以上步骤只适用于动态链接，静态链接并没有版本化的概念，以上步骤会导致静态编译时因为找不到 <code class="docutils literal"><span class="pre">rte_acl_create</span></code> 这个符号而失败。</p>
<p>要解决此问题，可以用MAP_STATIC_SYMBOL宏将指定函数映射到公用符号。一般来说要映射的特定函数就是最新版本的函数。因此，回到函数定义所在的.c文件，在 <code class="docutils literal"><span class="pre">rte_acl_create_v21</span></code> 定义之后，紧接着添加宏代码:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>struct rte_acl_ctx *
rte_acl_create_v21(const struct rte_acl_param *param, int debug)
{
     ...
}
MAP_STATIC_SYMBOL(struct rte_acl_ctx *rte_acl_create(const struct \
rte_acl_param *param, int debug), rte_acl_create_v21);
</pre></div>
</div>
<p>这告诉编译器在编译静态库时，把对符号 <code class="docutils literal"><span class="pre">rte_acl_create</span></code> 的调用链接到 <code class="docutils literal"><span class="pre">rte_acl_create_v21</span></code> 。</p>
<p>完成后，编译之后的新版本动态库，将含有2个版本的rte_acl_create，其中DPDK_2.0旧版本用于之前编译的用户程序，DPDK_2.1新版本用于未来编译的用户程序。</p>
</div>
</div>
<div class="section" id="id21">
<h3>18.6.4. 验证ABI<a class="headerlink" href="#id21" title="永久链接至标题">¶</a></h3>
<p>&lt;RTE_SDK&gt;/scripts目录中包含一个名为 <code class="docutils literal"><span class="pre">validate-abi.sh</span></code> 的脚本工具，
可用于验证DPDK ABI（基于Linux ABI Compliance Checker）。</p>
<p>详见：
<a class="reference external" href="http://dpdk.org/doc/guides/contributing/versioning.html#running-the-abi-validator">http://dpdk.org/doc/guides/contributing/versioning.html#running-the-abi-validator</a></p>
</div>
</div>
<div class="section" id="v16-07-2">
<h2>18.7. 实例：将v16.07.2编译为单个动态库<a class="headerlink" href="#v16-07-2" title="永久链接至标题">¶</a></h2>
<p>dpdk从某个版本（可能是16.04）起，编译系统取消了对“编译成一个动态库”的支持。如果还需要将dpdk（除内核驱动以外）编译成单个的.so文件，需要对编译系统的某些文件做一些修改。</p>
<div class="admonition note">
<p class="first admonition-title">注解</p>
<p class="last">以下描述只针对编译单个动态库的需求，如果有其他编译需求,
请参考相关文档</p>
</div>
<div class="section" id="config-common-base">
<h3>18.7.1. config/common_base<a class="headerlink" href="#config-common-base" title="永久链接至标题">¶</a></h3>
<p>修改:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>CONFIG_RTE_BUILD_SHARED_LIB=y
</pre></div>
</div>
<p>添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>CONFIG_RTE_BUILD_COMBINE_LIBS=y
CONFIG_RTE_LIBNAME=intel_dpdk
</pre></div>
</div>
</div>
<div class="section" id="mk-rte-lib-mk">
<h3>18.7.2. mk/rte.lib.mk<a class="headerlink" href="#mk-rte-lib-mk" title="永久链接至标题">¶</a></h3>
<p>在 <code class="docutils literal"><span class="pre">-include</span> <span class="pre">.$(LIB).cmd</span></code> 之前，添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(CONFIG_RTE_BUILD_SHARED_LIB),n)
O_TO_C = $(AR) crus $(LIB_ONE) $(OBJS-y)
O_TO_C_STR = $(subst &#39;,&#39;\&#39;&#39;,$(O_TO_C)) #&#39;# fix syntax highlight
O_TO_C_DISP = $(if $(V),&quot;$(O_TO_C_STR)&quot;,&quot;  AR_C $(@)&quot;)
O_TO_C_DO = @set -e; \
    $(lib_dir) \
    $(copy_obj)
else
O_TO_C = $(LD) -shared $(OBJS-y) -o $(LIB_ONE)
O_TO_C_STR = $(subst &#39;,&#39;\&#39;&#39;,$(O_TO_C)) #&#39;# fix syntax highlight
O_TO_C_DISP = $(if $(V),&quot;$(O_TO_C_STR)&quot;,&quot;  LD_C $(@)&quot;)
O_TO_C_DO = @set -e; \
    $(lib_dir) \
    $(copy_obj)
endif

copy_obj = cp -f $(OBJS-y) $(RTE_OUTPUT)/build/lib;
lib_dir = [ -d $(RTE_OUTPUT)/lib ] || mkdir -p $(RTE_OUTPUT)/lib;
</pre></div>
</div>
<p>$(copy_obj)把编译成的.o文件拷贝到$(RTE_OUTPUT)/build/lib目录。</p>
<p>在 <code class="docutils literal"><span class="pre">ifeq</span> <span class="pre">($(CONFIG_RTE_BUILD_SHARED_LIB),</span> <span class="pre">y)</span></code> 判断语句块的第一个else前，添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(CONFIG_RTE_BUILD_COMBINE_LIBS),y)
    $(if $(or \
        $(file_missing),\
        $(call cmdline_changed,$(O_TO_C_STR)),\
        $(depfile_missing),\
        $(depfile_newer)),\
        $(O_TO_C_DO))
endif
</pre></div>
</div>
<p>在这语句块结束的最后一个 <code class="docutils literal"><span class="pre">endif</span></code> 前，添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(CONFIG_RTE_BUILD_COMBINE_LIBS),y)
    $(if $(or \
        $(file_missing),\
        $(call cmdline_changed,$(O_TO_C_STR)),\
        $(depfile_missing),\
        $(depfile_newer)),\
        $(O_TO_C_DO))
endif
</pre></div>
</div>
</div>
<div class="section" id="mk-rte-combinedlib-mk">
<h3>18.7.3. mk/rte.combinedlib.mk<a class="headerlink" href="#mk-rte-combinedlib-mk" title="永久链接至标题">¶</a></h3>
<p>首先要包含rte.build-pre.mk:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>include $(RTE_SDK)/mk/internal/rte.build-pre.mk
</pre></div>
</div>
<p>修改输出库文件名，删除:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>RTE_LIBNAME := dpdk
</pre></div>
</div>
<p>因为库名称在common_base文件中配置了。修改:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>COMBINEDLIB := lib$(CONFIG_RTE_LIBNAME)$(EXT)
</pre></div>
</div>
<p>在LIBS后面添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>OBJS = $(wildcard $(RTE_OUTPUT)/build/lib/*.o)
CPU_LDFLAGS += --version-script=$(SRCDIR)/lib/libdpdk.map
</pre></div>
</div>
<p>之后需要链接OBJS，libdpdk.map是上文说到的版本控制脚本。</p>
<p>在 <code class="docutils literal"><span class="pre">all:</span> <span class="pre">FORCE</span></code> 前添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(LINK_USING_CC),1)
# Override the definition of LD here, since we&#39;re linking with CC
LD := $(CC) $(CPU_CFLAGS)
O_TO_S = $(LD) $(call linkerprefix,$(CPU_LDFLAGS)) \
    -shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(COMBINEDLIB)
else
O_TO_S = $(LD) $(CPU_LDFLAGS) \
    -shared $(OBJS) -o $(RTE_OUTPUT)/lib/$(COMBINEDLIB)
endif

O_TO_S_STR = $(subst &#39;,&#39;\&#39;&#39;,$(O_TO_S)) #&#39;# fix syntax highlight
O_TO_S_DISP = $(if $(V),&quot;$(O_TO_S_STR)&quot;,&quot;  LD $(@)&quot;)
O_TO_S_CMD = &quot;cmd_$@ = $(O_TO_S_STR)&quot;
O_TO_S_DO = @set -e; \
    echo $(O_TO_S_DISP); \
    $(O_TO_S)
</pre></div>
</div>
<p>修改all目标( <code class="docutils literal"><span class="pre">all:</span> <span class="pre">FORCE</span></code> 下一行）:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>all: FORCE
    $(O_TO_S_DO)
</pre></div>
</div>
</div>
<div class="section" id="mk-rte-app-mk">
<h3>18.7.4. mk/rte.app.mk<a class="headerlink" href="#mk-rte-app-mk" title="永久链接至标题">¶</a></h3>
<p>此文件改动较大。首先在 <code class="docutils literal"><span class="pre">_LDLIBS-y</span> <span class="pre">+=</span> <span class="pre">-L$(RTE_SDK_BIN)/lib</span></code> 之后添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>_LDLIBS-$(CONFIG_RTE_BUILD_COMBINE_LIBS)    += -l$(CONFIG_RTE_LIBNAME)
_LDLIBS-y += -lm
_LDLIBS-y += -lpcap
</pre></div>
</div>
<p>之后，在 <code class="docutils literal"><span class="pre">_LDLIBS-y</span> <span class="pre">+=</span> <span class="pre">--whole-archive</span></code> 之前，修改为:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(CONFIG_RTE_BUILD_COMBINE_LIBS),n)

_LDLIBS-$(CONFIG_RTE_LIBRTE_DISTRIBUTOR)    += -lrte_distributor
_LDLIBS-$(CONFIG_RTE_LIBRTE_REORDER)        += -lrte_reorder
ifeq ($(CONFIG_RTE_EXEC_ENV_LINUXAPP),y)
_LDLIBS-$(CONFIG_RTE_LIBRTE_KNI)            += -lrte_kni
_LDLIBS-$(CONFIG_RTE_LIBRTE_IVSHMEM)        += -lrte_ivshmem
endif

_LDLIBS-$(CONFIG_RTE_LIBRTE_PIPELINE)       += -lrte_pipeline
_LDLIBS-$(CONFIG_RTE_LIBRTE_TABLE)          += -lrte_table
_LDLIBS-$(CONFIG_RTE_LIBRTE_PORT)           += -lrte_port
_LDLIBS-$(CONFIG_RTE_LIBRTE_TIMER)          += -lrte_timer
_LDLIBS-$(CONFIG_RTE_LIBRTE_HASH)           += -lrte_hash
_LDLIBS-$(CONFIG_RTE_LIBRTE_JOBSTATS)       += -lrte_jobstats
_LDLIBS-$(CONFIG_RTE_LIBRTE_LPM)            += -lrte_lpm
_LDLIBS-$(CONFIG_RTE_LIBRTE_POWER)          += -lrte_power
# librte_acl needs --whole-archive because of weak functions
_LDLIBS-$(CONFIG_RTE_LIBRTE_ACL)            += --whole-archive
_LDLIBS-$(CONFIG_RTE_LIBRTE_ACL)            += -lrte_acl
_LDLIBS-$(CONFIG_RTE_LIBRTE_ACL)            += --no-whole-archive
_LDLIBS-$(CONFIG_RTE_LIBRTE_PDUMP)          += -lrte_pdump
_LDLIBS-$(CONFIG_RTE_LIBRTE_IP_FRAG)        += -lrte_ip_frag
_LDLIBS-$(CONFIG_RTE_LIBRTE_METER)          += -lrte_meter
_LDLIBS-$(CONFIG_RTE_LIBRTE_SCHED)          += -lrte_sched
_LDLIBS-$(CONFIG_RTE_LIBRTE_VHOST)          += -lrte_vhost

endif # ! CONFIG_RTE_BUILD_COMBINE_LIBS
</pre></div>
</div>
<p>之后，在 <code class="docutils literal"><span class="pre">_LDLIBS-$(CONFIG_RTE_LIBRTE_KVARGS)</span> <span class="pre">+=</span> <span class="pre">-lrte_kvargs</span></code>
之前，添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(CONFIG_RTE_BUILD_SHARED_LIB),n)
# The static libraries do not know their dependencies.
# So linking with static library requires explicit dependencies.
_LDLIBS-$(CONFIG_RTE_LIBRTE_EAL)            += -lrt
_LDLIBS-$(CONFIG_RTE_LIBRTE_SCHED)          += -lm
_LDLIBS-$(CONFIG_RTE_LIBRTE_SCHED)          += -lrt
_LDLIBS-$(CONFIG_RTE_LIBRTE_METER)          += -lm
ifeq ($(CONFIG_RTE_LIBRTE_VHOST_NUMA),y)
_LDLIBS-$(CONFIG_RTE_LIBRTE_VHOST)          += -lnuma
endif
ifeq ($(CONFIG_RTE_LIBRTE_VHOST_USER),n)
_LDLIBS-$(CONFIG_RTE_LIBRTE_VHOST)          += -lfuse
endif
_LDLIBS-$(CONFIG_RTE_PORT_PCAP)             += -lpcap
endif # !CONFIG_RTE_BUILD_SHARED_LIB


_LDLIBS-y += --start-group
ifeq ($(CONFIG_RTE_BUILD_COMBINE_LIBS),n)
</pre></div>
</div>
<p>之后，在 <code class="docutils literal"><span class="pre">endif</span> <span class="pre">#</span> <span class="pre">CONFIG_RTE_LIBRTE_CRYPTODEV</span></code> 之后，
<code class="docutils literal"><span class="pre">_LDLIBS-y</span> <span class="pre">+=</span> <span class="pre">--no-whole-archive</span></code> 之前，添加:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>endif # !CONFIG_RTE_BUILD_SHARED_LIB
endif # ! CONFIG_RTE_BUILD_COMBINE_LIBS

_LDLIBS-y += $(EXECENV_LDLIBS)
_LDLIBS-y += --end-group
</pre></div>
</div>
<p>删除下面的:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>_LDLIBS-y += $(EXECENV_LDLIBS)
</pre></div>
</div>
<p>最后，将 <code class="docutils literal"><span class="pre">exe2cmd</span> <span class="pre">=</span> <span class="pre">$(strip</span> <span class="pre">$(call</span> <span class="pre">dotfile,$(patsubst</span> <span class="pre">%,%.cmd,$(1))))</span></code>
之后，<code class="docutils literal"><span class="pre">O_TO_EXE_STR</span> <span class="pre">=</span> <span class="pre">$(subst</span> <span class="pre">','\'',$(O_TO_EXE))</span> <span class="pre">#'#</span> <span class="pre">fix</span> <span class="pre">syntax</span> <span class="pre">highlight</span></code>
之前的内容，修改为:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>ifeq ($(LINK_USING_CC),1)
override EXTRA_LDFLAGS := $(call linkerprefix,$(EXTRA_LDFLAGS))
O_TO_EXE = $(CC) $(CFLAGS) $(LDFLAGS_$(@)) \
    -Wl,-Map=$(@).map,--cref -o $@ $(OBJS-y) $(call linkerprefix,$(LDFLAGS)) \
    $(EXTRA_LDFLAGS) $(call linkerprefix,$(LDLIBS))
else
O_TO_EXE = $(LD) $(LDFLAGS) $(LDFLAGS_$(@)) $(EXTRA_LDFLAGS) \
    -Map=$(@).map --cref -o $@ $(OBJS-y) $(LDLIBS)
endif
</pre></div>
</div>
</div>
<div class="section" id="libdpdk-map">
<h3>18.7.5. libdpdk.map<a class="headerlink" href="#libdpdk-map" title="永久链接至标题">¶</a></h3>
<p>最后，需要提供一个版本控制脚本libdpdk.map，将它放在$RTE_SDK/lib目录中，
该文件内容为:</p>
<div class="highlight-text"><div class="highlight"><pre><span></span>DPDK_2.0 {

};

DPDK_2.1 {

} DPDK_2.0;

DPDK_2.2 {

} DPDK_2.1;

DPDK_16.04 {

} DPDK_2.2;

DPDK_16.07 {

} DPDK_16.04;
</pre></div>
</div>
<p>附： <a class="reference external" href="./dpdk16.07_patch">patch文件</a></p>
</div>
</div>
<div class="section" id="id22">
<h2>18.8. 参考<a class="headerlink" href="#id22" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><a class="reference external" href="http://dpdk.org/doc/guides/prog_guide/source_org.html">DPDK Programmer&#8217;s Guide - Source Organization </a></li>
<li><a class="reference external" href="http://dpdk.org/doc/guides/prog_guide/dev_kit_build_system.html">DPDK Programmer&#8217;s Guide - Development Kit Build System </a></li>
<li><a class="reference external" href="http://dpdk.org/doc/guides/prog_guide/dev_kit_root_make_help.html">DPDK Programmer&#8217;s Guide - Development Kit Root Makefile Help </a></li>
<li><a class="reference external" href="http://dpdk.org/doc/guides/contributing/versioning.html">DPDK Contributor&#8217;s Guidelines - Managing ABI updates </a></li>
</ul>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../net/links.html" class="btn btn-neutral float-right" title="参考链接" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mbuf.html" class="btn btn-neutral" title="17. 源码分析: Mbuf" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, 赵子清.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'2019.03.15',
            LANGUAGE:'zh',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>